use iced_x86::{Decoder, DecoderOptions, Instruction, OpKind};
use crate::cpu::state::CpuState;
use crate::cpu::registers::RFlags;
use crate::Result;
use iced_x86::Mnemonic;

mod a;
mod b;
mod c;
mod d;
mod e;
mod f;
mod g;
mod h;
mod i;
mod j;
mod k;
mod l;
mod m;
mod n;
mod o;
mod p;
mod q;
mod r;
mod s;
mod t;
mod u;
mod v;
mod w;
mod x;
mod y;
mod z;

/// Instruction decoder and executor
pub struct InstructionDecoder <'a> {
    decoder: Decoder<'a>,
}

impl InstructionDecoder<'_> {
    pub fn new() -> Self {
        Self {
            decoder: Decoder::new(64, &[], DecoderOptions::NONE),
        }
    }

    pub fn decode_instruction(&mut self, code: &[u8]) -> Instruction {
        // Create a new decoder for each instruction
        let mut decoder = Decoder::new(64, code, DecoderOptions::NONE);
        decoder.decode()
    }

    pub fn execute_instruction(&self, instruction: &Instruction, state: &mut CpuState) -> Result<()> {
        match instruction.mnemonic() {
            Mnemonic::INVALID => Err(crate::EmulatorError::Cpu("Invalid instruction".to_string())),
            // A
            Mnemonic::Aaa => self.execute_aaa(instruction, state),
            Mnemonic::Aad => self.execute_aad(instruction, state),
            Mnemonic::Aam => self.execute_aam(instruction, state),
            Mnemonic::Aas => self.execute_aas(instruction, state),
            Mnemonic::Adc => self.execute_adc(instruction, state),
            Mnemonic::Adcx => self.execute_adcx(instruction, state),
            Mnemonic::Add => self.execute_add(instruction, state),
            Mnemonic::Addpd => self.execute_addpd(instruction, state),
            Mnemonic::Addps => self.execute_addps(instruction, state),
            Mnemonic::Addsd => self.execute_addsd(instruction, state),
            Mnemonic::Addss => self.execute_addss(instruction, state),
            Mnemonic::Addsubpd => self.execute_addsubpd(instruction, state),
            Mnemonic::Addsubps => self.execute_addsubps(instruction, state),
            Mnemonic::Adox => self.execute_adox(instruction, state),
            Mnemonic::Aesdec => self.execute_aesdec(instruction, state),
            Mnemonic::Aesdeclast => self.execute_aesdeclast(instruction, state),
            Mnemonic::Aesenc => self.execute_aesenc(instruction, state),
            Mnemonic::Aesenclast => self.execute_aesenclast(instruction, state),
            Mnemonic::Aesimc => self.execute_aesimc(instruction, state),
            Mnemonic::Aeskeygenassist => self.execute_aeskeygenassist(instruction, state),
            Mnemonic::And => self.execute_and(instruction, state),
            Mnemonic::Andn => self.execute_andn(instruction, state),
            Mnemonic::Andnpd => self.execute_andnpd(instruction, state),
            Mnemonic::Andnps => self.execute_andnps(instruction, state),
            Mnemonic::Andpd => self.execute_andpd(instruction, state),
            Mnemonic::Andps => self.execute_andps(instruction, state),
            Mnemonic::Arpl => self.execute_arpl(instruction, state),
            // B
            Mnemonic::Bextr => self.execute_bextr(instruction, state),
            Mnemonic::Blcfill => self.execute_blcfill(instruction, state),
            Mnemonic::Blci => self.execute_blci(instruction, state),
            Mnemonic::Blcic => self.execute_blcic(instruction, state),
            Mnemonic::Blcmsk => self.execute_blcmsk(instruction, state),
            Mnemonic::Blcs => self.execute_blcs(instruction, state),
            Mnemonic::Blendpd => self.execute_blendpd(instruction, state),
            Mnemonic::Blendps => self.execute_blendps(instruction, state),
            Mnemonic::Blendvpd => self.execute_blendvpd(instruction, state),
            Mnemonic::Blendvps => self.execute_blendvps(instruction, state),
            Mnemonic::Blsfill => self.execute_blsfill(instruction, state),
            Mnemonic::Blsi => self.execute_blsi(instruction, state),
            Mnemonic::Blsic => self.execute_blsic(instruction, state),
            Mnemonic::Blsmsk => self.execute_blsmask(instruction, state),
            Mnemonic::Blsr => self.execute_blsr(instruction, state),
            Mnemonic::Bndcl => self.execute_bndcl(instruction, state),
            Mnemonic::Bndcn => self.execute_bndcn(instruction, state),
            Mnemonic::Bndcu => self.execute_bndcu(instruction, state),
            Mnemonic::Bndldx => self.execute_bndldx(instruction, state),
            Mnemonic::Bndmk => self.execute_bndmk(instruction, state),
            Mnemonic::Bndmov => self.execute_bndmov(instruction, state),
            Mnemonic::Bndstx => self.execute_bndstx(instruction, state),
            Mnemonic::Bound => self.execute_bound(instruction, state),
            Mnemonic::Bsf => self.execute_bsf(instruction, state),
            Mnemonic::Bsr => self.execute_bsr(instruction, state),
            Mnemonic::Bswap => self.execute_bswap(instruction, state),
            Mnemonic::Bt => self.execute_bt(instruction, state),
            Mnemonic::Btc => self.execute_btc(instruction, state),
            Mnemonic::Btr => self.execute_btr(instruction, state),
            Mnemonic::Bts => self.execute_bts(instruction, state),
            Mnemonic::Bzhi => self.execute_bzhi(instruction, state),
            // C
            Mnemonic::Call => self.execute_call(instruction, state),
            Mnemonic::Cbw => self.execute_cbw(instruction, state),
            Mnemonic::Cdq => self.execute_cdq(instruction, state),
            Mnemonic::Cdqe => self.execute_cdqe(instruction, state),
            Mnemonic::Cl1invmb => todo!(),
            Mnemonic::Clac => self.execute_clac(instruction, state),
            Mnemonic::Clc => self.execute_clc(instruction, state),
            Mnemonic::Cld => self.execute_cld(instruction, state),
            Mnemonic::Cldemote => self.execute_cldemote(instruction, state),
            Mnemonic::Clflush => self.execute_clflush(instruction, state),
            Mnemonic::Clflushopt => self.execute_clflushopt(instruction, state),
            Mnemonic::Clgi => self.execute_clgi(instruction, state),
            Mnemonic::Cli => self.execute_cli(instruction, state),
            Mnemonic::Clrssbsy => self.execute_clrssbsy(instruction, state),
            Mnemonic::Clts => self.execute_clts(instruction, state),
            Mnemonic::Clwb => self.execute_clwb(instruction, state),
            Mnemonic::Clzero => self.execute_clzero(instruction, state),
            Mnemonic::Cmc => self.execute_cmc(instruction, state),
            Mnemonic::Cmova => self.execute_cmova(instruction, state),
            Mnemonic::Cmovae => self.execute_cmovae(instruction, state),
            Mnemonic::Cmovb => self.execute_cmovb(instruction, state),
            Mnemonic::Cmovbe => self.execute_cmovbe(instruction, state),
            Mnemonic::Cmove => self.execute_cmove(instruction, state),
            Mnemonic::Cmovg => self.execute_cmovg(instruction, state),
            Mnemonic::Cmovge => self.execute_cmovge(instruction, state),
            Mnemonic::Cmovl => self.execute_cmovl(instruction, state),
            Mnemonic::Cmovle => self.execute_cmovle(instruction, state),
            Mnemonic::Cmovne => self.execute_cmovne(instruction, state),
            Mnemonic::Cmovno => self.execute_cmovno(instruction, state),
            Mnemonic::Cmovnp => self.execute_cmovnp(instruction, state),
            Mnemonic::Cmovns => self.execute_cmovns(instruction, state),
            Mnemonic::Cmovo => self.execute_cmovo(instruction, state),
            Mnemonic::Cmovp => self.execute_cmovp(instruction, state),
            Mnemonic::Cmovs => self.execute_cmovs(instruction, state),
            Mnemonic::Cmp => self.execute_cmp(instruction, state),
            Mnemonic::Cmppd => self.execute_cmppd(instruction, state),
            Mnemonic::Cmpps => self.execute_cmpps(instruction, state),
            Mnemonic::Cmpsb => self.execute_cmpsb(instruction, state),
            Mnemonic::Cmpsd => self.execute_cmpsd(instruction, state),
            Mnemonic::Cmpsq => self.execute_cmpsq(instruction, state),
            Mnemonic::Cmpss => self.execute_cmpss(instruction, state),
            Mnemonic::Cmpsw => self.execute_cmpsw(instruction, state),
            Mnemonic::Cmpxchg => self.execute_cmpxchg(instruction, state),
            Mnemonic::Cmpxchg16b => todo!(),
            Mnemonic::Cmpxchg8b => todo!(),
            Mnemonic::Comisd => self.execute_comisd(instruction, state),
            Mnemonic::Comiss => self.execute_comiss(instruction, state),
            Mnemonic::Cpuid => self.execute_cpuid(instruction, state),
            Mnemonic::Cqo => self.execute_cqo(instruction, state),
            Mnemonic::Crc32 => todo!(),
            Mnemonic::Cvtdq2pd => todo!(),
            Mnemonic::Cvtdq2ps => todo!(),
            Mnemonic::Cvtpd2dq => todo!(),
            Mnemonic::Cvtpd2pi => todo!(),
            Mnemonic::Cvtpd2ps => todo!(),
            Mnemonic::Cvtpi2pd => todo!(),
            Mnemonic::Cvtpi2ps => todo!(),
            Mnemonic::Cvtps2dq => todo!(),
            Mnemonic::Cvtps2pd => todo!(),
            Mnemonic::Cvtps2pi => todo!(),
            Mnemonic::Cvtsd2si => todo!(),
            Mnemonic::Cvtsd2ss => todo!(),
            Mnemonic::Cvtsi2sd => todo!(),
            Mnemonic::Cvtsi2ss => todo!(),
            Mnemonic::Cvtss2sd => todo!(),
            Mnemonic::Cvtss2si => todo!(),
            Mnemonic::Cvttpd2dq => todo!(),
            Mnemonic::Cvttpd2pi => todo!(),
            Mnemonic::Cvttps2dq => todo!(),
            Mnemonic::Cvttps2pi => todo!(),
            Mnemonic::Cvttsd2si => todo!(),
            Mnemonic::Cvttss2si => todo!(),
            Mnemonic::Cwd => self.execute_cwd(instruction, state),
            Mnemonic::Cwde => self.execute_cwde(instruction, state),
            // D
            Mnemonic::Daa => self.execute_daa(instruction, state),
            Mnemonic::Das => self.execute_das(instruction, state),
            Mnemonic::Db => todo!(),
            Mnemonic::Dd => todo!(),
            Mnemonic::Dec => self.execute_dec(instruction, state),
            Mnemonic::Div => self.execute_div(instruction, state),
            Mnemonic::Divpd => todo!(),
            Mnemonic::Divps => todo!(),
            Mnemonic::Divsd => todo!(),
            Mnemonic::Divss => todo!(),
            Mnemonic::Dppd => todo!(),
            Mnemonic::Dpps => todo!(),
            Mnemonic::Dq => todo!(),
            Mnemonic::Dw => todo!(),
            // E
            Mnemonic::Emms => todo!(),
            Mnemonic::Encls => todo!(),
            Mnemonic::Enclu => todo!(),
            Mnemonic::Enclv => todo!(),
            Mnemonic::Endbr32 => todo!(),
            Mnemonic::Endbr64 => todo!(),
            Mnemonic::Enqcmd => todo!(),
            Mnemonic::Enqcmds => todo!(),
            Mnemonic::Enter => self.execute_enter(instruction, state),
            Mnemonic::Extractps => todo!(),
            Mnemonic::Extrq => todo!(),
            // F
            Mnemonic::F2xm1 => todo!(),
            Mnemonic::Fabs => todo!(),
            Mnemonic::Fadd => todo!(),
            Mnemonic::Faddp => todo!(),
            Mnemonic::Fbld => todo!(),
            Mnemonic::Fbstp => todo!(),
            Mnemonic::Fchs => todo!(),
            Mnemonic::Fclex => todo!(),
            Mnemonic::Fcmovb => todo!(),
            Mnemonic::Fcmovbe => todo!(),
            Mnemonic::Fcmove => todo!(),
            Mnemonic::Fcmovnb => todo!(),
            Mnemonic::Fcmovnbe => todo!(),
            Mnemonic::Fcmovne => todo!(),
            Mnemonic::Fcmovnu => todo!(),
            Mnemonic::Fcmovu => todo!(),
            Mnemonic::Fcom => todo!(),
            Mnemonic::Fcomi => todo!(),
            Mnemonic::Fcomip => todo!(),
            Mnemonic::Fcomp => todo!(),
            Mnemonic::Fcompp => todo!(),
            Mnemonic::Fcos => todo!(),
            Mnemonic::Fdecstp => todo!(),
            Mnemonic::Fdisi => todo!(),
            Mnemonic::Fdiv => todo!(),
            Mnemonic::Fdivp => todo!(),
            Mnemonic::Fdivr => todo!(),
            Mnemonic::Fdivrp => todo!(),
            Mnemonic::Femms => todo!(),
            Mnemonic::Feni => todo!(),
            Mnemonic::Ffree => todo!(),
            Mnemonic::Ffreep => todo!(),
            Mnemonic::Fiadd => todo!(),
            Mnemonic::Ficom => todo!(),
            Mnemonic::Ficomp => todo!(),
            Mnemonic::Fidiv => todo!(),
            Mnemonic::Fidivr => todo!(),
            Mnemonic::Fild => todo!(),
            Mnemonic::Fimul => todo!(),
            Mnemonic::Fincstp => todo!(),
            Mnemonic::Finit => todo!(),
            Mnemonic::Fist => todo!(),
            Mnemonic::Fistp => todo!(),
            Mnemonic::Fisttp => todo!(),
            Mnemonic::Fisub => todo!(),
            Mnemonic::Fisubr => todo!(),
            Mnemonic::Fld => todo!(),
            Mnemonic::Fld1 => todo!(),
            Mnemonic::Fldcw => todo!(),
            Mnemonic::Fldenv => todo!(),
            Mnemonic::Fldl2e => todo!(),
            Mnemonic::Fldl2t => todo!(),
            Mnemonic::Fldlg2 => todo!(),
            Mnemonic::Fldln2 => todo!(),
            Mnemonic::Fldpi => todo!(),
            Mnemonic::Fldz => todo!(),
            Mnemonic::Fmul => todo!(),
            Mnemonic::Fmulp => todo!(),
            Mnemonic::Fnclex => todo!(),
            Mnemonic::Fndisi => todo!(),
            Mnemonic::Fneni => todo!(),
            Mnemonic::Fninit => todo!(),
            Mnemonic::Fnop => todo!(),
            Mnemonic::Fnsave => todo!(),
            Mnemonic::Fnsetpm => todo!(),
            Mnemonic::Fnstcw => todo!(),
            Mnemonic::Fnstenv => todo!(),
            Mnemonic::Fnstsw => todo!(),
            Mnemonic::Fpatan => todo!(),
            Mnemonic::Fprem => todo!(),
            Mnemonic::Fprem1 => todo!(),
            Mnemonic::Fptan => todo!(),
            Mnemonic::Frndint => todo!(),
            Mnemonic::Frstor => todo!(),
            Mnemonic::Frstpm => todo!(),
            Mnemonic::Fsave => todo!(),
            Mnemonic::Fscale => todo!(),
            Mnemonic::Fsetpm => todo!(),
            Mnemonic::Fsin => todo!(),
            Mnemonic::Fsincos => todo!(),
            Mnemonic::Fsqrt => todo!(),
            Mnemonic::Fst => todo!(),
            Mnemonic::Fstcw => todo!(),
            Mnemonic::Fstdw => todo!(),
            Mnemonic::Fstenv => todo!(),
            Mnemonic::Fstp => todo!(),
            Mnemonic::Fstpnce => todo!(),
            Mnemonic::Fstsg => todo!(),
            Mnemonic::Fstsw => todo!(),
            Mnemonic::Fsub => todo!(),
            Mnemonic::Fsubp => todo!(),
            Mnemonic::Fsubr => todo!(),
            Mnemonic::Fsubrp => todo!(),
            Mnemonic::Ftst => todo!(),
            Mnemonic::Fucom => todo!(),
            Mnemonic::Fucomi => todo!(),
            Mnemonic::Fucomip => todo!(),
            Mnemonic::Fucomp => todo!(),
            Mnemonic::Fucompp => todo!(),
            Mnemonic::Fxam => todo!(),
            Mnemonic::Fxch => todo!(),
            Mnemonic::Fxrstor => todo!(),
            Mnemonic::Fxrstor64 => todo!(),
            Mnemonic::Fxsave => todo!(),
            Mnemonic::Fxsave64 => todo!(),
            Mnemonic::Fxtract => todo!(),
            Mnemonic::Fyl2x => todo!(),
            Mnemonic::Fyl2xp1 => todo!(),
            // G
            Mnemonic::Getsec => todo!(),
            Mnemonic::Gf2p8affineinvqb => todo!(),
            Mnemonic::Gf2p8affineqb => todo!(),
            Mnemonic::Gf2p8mulb => todo!(),
            // H
            Mnemonic::Haddpd => todo!(),
            Mnemonic::Haddps => todo!(),
            Mnemonic::Hlt => self.execute_hlt(instruction, state),
            Mnemonic::Hsubpd => todo!(),
            Mnemonic::Hsubps => todo!(),
            // I
            Mnemonic::Ibts => todo!(),
            Mnemonic::Idiv => self.execute_idiv(instruction, state),
            Mnemonic::Imul => self.execute_imul(instruction, state),
            Mnemonic::In => self.execute_in(instruction, state),
            Mnemonic::Inc => self.execute_inc(instruction, state),
            Mnemonic::Incsspd => todo!(),
            Mnemonic::Incsspq => todo!(),
            Mnemonic::Insb => self.execute_insb(instruction, state),
            Mnemonic::Insd => self.execute_insd(instruction, state),
            Mnemonic::Insertps => todo!(),
            Mnemonic::Insertq => todo!(),
            Mnemonic::Insw => self.execute_insw(instruction, state),
            Mnemonic::Int => self.execute_int(instruction, state),
            Mnemonic::Int1 => todo!(),
            Mnemonic::Into => self.execute_into(instruction, state),
            Mnemonic::Invd => self.execute_invd(instruction, state),
            Mnemonic::Invept => todo!(),
            Mnemonic::Invlpg => self.execute_invlpg(instruction, state),
            Mnemonic::Invlpga => todo!(),
            Mnemonic::Invpcid => todo!(),
            Mnemonic::Invvpid => todo!(),
            Mnemonic::Iret => self.execute_iret(instruction, state),
            // J
            Mnemonic::Ja => self.execute_ja(instruction, state),
            Mnemonic::Jae => self.execute_jae(instruction, state),
            Mnemonic::Jb => self.execute_jb(instruction, state),
            Mnemonic::Jbe => self.execute_jbe(instruction, state),
            Mnemonic::Jcxz => self.execute_jcxz(instruction, state),
            Mnemonic::Je => self.execute_je(instruction, state),
            Mnemonic::Jecxz => self.execute_jecxz(instruction, state),
            Mnemonic::Jg => self.execute_jg(instruction, state),
            Mnemonic::Jge => self.execute_jge(instruction, state),
            Mnemonic::Jl => self.execute_jl(instruction, state),
            Mnemonic::Jle => self.execute_jle(instruction, state),
            Mnemonic::Jmp => self.execute_jmp(instruction, state),
            Mnemonic::Jne => self.execute_jne(instruction, state),
            Mnemonic::Jno => self.execute_jno(instruction, state),
            Mnemonic::Jns => self.execute_jns(instruction, state),
            Mnemonic::Jo => self.execute_jo(instruction, state),
            Mnemonic::Jrcxz => self.execute_jrcxz(instruction, state),
            Mnemonic::Js => self.execute_js(instruction, state),
            Mnemonic::Jmpe => todo!(),
            Mnemonic::Jnp => todo!(),
            Mnemonic::Jp => todo!(),
            // K
            Mnemonic::Kaddb => todo!(),
            Mnemonic::Kaddd => todo!(),
            Mnemonic::Kaddq => todo!(),
            Mnemonic::Kaddw => todo!(),
            Mnemonic::Kandb => todo!(),
            Mnemonic::Kandd => todo!(),
            Mnemonic::Kandnb => todo!(),
            Mnemonic::Kandnd => todo!(),
            Mnemonic::Kandnq => todo!(),
            Mnemonic::Kandnw => todo!(),
            Mnemonic::Kandq => todo!(),
            Mnemonic::Kandw => todo!(),
            Mnemonic::Kmovb => todo!(),
            Mnemonic::Kmovd => todo!(),
            Mnemonic::Kmovq => todo!(),
            Mnemonic::Kmovw => todo!(),
            Mnemonic::Knotb => todo!(),
            Mnemonic::Knotd => todo!(),
            Mnemonic::Knotq => todo!(),
            Mnemonic::Knotw => todo!(),
            Mnemonic::Korb => todo!(),
            Mnemonic::Kord => todo!(),
            Mnemonic::Korq => todo!(),
            Mnemonic::Kortestb => todo!(),
            Mnemonic::Kortestd => todo!(),
            Mnemonic::Kortestq => todo!(),
            Mnemonic::Kortestw => todo!(),
            Mnemonic::Korw => todo!(),
            Mnemonic::Kshiftlb => todo!(),
            Mnemonic::Kshiftld => todo!(),
            Mnemonic::Kshiftlq => todo!(),
            Mnemonic::Kshiftlw => todo!(),
            Mnemonic::Kshiftrb => todo!(),
            Mnemonic::Kshiftrd => todo!(),
            Mnemonic::Kshiftrq => todo!(),
            Mnemonic::Kshiftrw => todo!(),
            Mnemonic::Ktestb => todo!(),
            Mnemonic::Ktestd => todo!(),
            Mnemonic::Ktestq => todo!(),
            Mnemonic::Ktestw => todo!(),
            Mnemonic::Kunpckbw => todo!(),
            Mnemonic::Kunpckdq => todo!(),
            Mnemonic::Kunpckwd => todo!(),
            Mnemonic::Kxnorb => todo!(),
            Mnemonic::Kxnord => todo!(),
            Mnemonic::Kxnorq => todo!(),
            Mnemonic::Kxnorw => todo!(),
            Mnemonic::Kxorb => todo!(),
            Mnemonic::Kxord => todo!(),
            Mnemonic::Kxorq => todo!(),
            Mnemonic::Kxorw => todo!(),
            // L
            Mnemonic::Lahf => self.execute_lahf(instruction, state),
            Mnemonic::Lar => self.execute_lar(instruction, state),
            Mnemonic::Lds => self.execute_lds(instruction, state),
            Mnemonic::Lea => self.execute_lea(instruction, state),
            Mnemonic::Leave => self.execute_leave(instruction, state),
            Mnemonic::Les => self.execute_les(instruction, state),
            Mnemonic::Lfence => self.execute_lfence(instruction, state),
            Mnemonic::Lfs => self.execute_lfs(instruction, state),
            Mnemonic::Lgdt => self.execute_lgdt(instruction, state),
            Mnemonic::Lgs => self.execute_lgs(instruction, state),
            Mnemonic::Lidt => self.execute_lidt(instruction, state),
            Mnemonic::Lldt => self.execute_lldt(instruction, state),
            Mnemonic::Lmsw => self.execute_lmsw(instruction, state),
            Mnemonic::Lodsb => self.execute_lodsb(instruction, state),
            Mnemonic::Lodsd => self.execute_lodsd(instruction, state),
            Mnemonic::Lodsq => self.execute_lodsq(instruction, state),
            Mnemonic::Lodsw => self.execute_lodsw(instruction, state),
            Mnemonic::Loop => self.execute_loop(instruction, state),
            Mnemonic::Loope => self.execute_loope(instruction, state),
            Mnemonic::Loopne => self.execute_loopne(instruction, state),
            Mnemonic::Lsl => self.execute_lsl(instruction, state),
            Mnemonic::Lss => self.execute_lss(instruction, state),
            Mnemonic::Ltr => self.execute_ltr(instruction, state),
            Mnemonic::Lddqu => todo!(),
            Mnemonic::Ldmxcsr => todo!(),
            Mnemonic::Llwpcb => todo!(),
            Mnemonic::Loadall => todo!(),
            Mnemonic::Lwpins => todo!(),
            Mnemonic::Lwpval => todo!(),
            Mnemonic::Lzcnt => todo!(),
            // M
            Mnemonic::Mfence => self.execute_mfence(instruction, state),
            Mnemonic::Mov => self.execute_mov(instruction, state),
            Mnemonic::Movsb => self.execute_movsb(instruction, state),
            Mnemonic::Movsd => self.execute_movsd(instruction, state),
            Mnemonic::Movsq => self.execute_movsq(instruction, state),
            Mnemonic::Movsw => self.execute_movsw(instruction, state),
            Mnemonic::Movsx => self.execute_movsx(instruction, state),
            Mnemonic::Movzx => self.execute_movzx(instruction, state),
            Mnemonic::Mul => self.execute_mul(instruction, state),
            Mnemonic::Maskmovdqu => todo!(),
            Mnemonic::Maskmovq => todo!(),
            Mnemonic::Maxpd => todo!(),
            Mnemonic::Maxps => todo!(),
            Mnemonic::Maxsd => todo!(),
            Mnemonic::Maxss => todo!(),
            Mnemonic::Mcommit => todo!(),
            Mnemonic::Minpd => todo!(),
            Mnemonic::Minps => todo!(),
            Mnemonic::Minsd => todo!(),
            Mnemonic::Minss => todo!(),
            Mnemonic::Monitor => todo!(),
            Mnemonic::Monitorx => todo!(),
            Mnemonic::Montmul => todo!(),
            Mnemonic::Movapd => todo!(),
            Mnemonic::Movaps => todo!(),
            Mnemonic::Movbe => todo!(),
            Mnemonic::Movd => todo!(),
            Mnemonic::Movddup => todo!(),
            Mnemonic::Movdir64b => todo!(),
            Mnemonic::Movdiri => todo!(),
            Mnemonic::Movdq2q => todo!(),
            Mnemonic::Movdqa => todo!(),
            Mnemonic::Movdqu => todo!(),
            Mnemonic::Movhlps => todo!(),
            Mnemonic::Movhpd => todo!(),
            Mnemonic::Movhps => todo!(),
            Mnemonic::Movlhps => todo!(),
            Mnemonic::Movlpd => todo!(),
            Mnemonic::Movlps => todo!(),
            Mnemonic::Movmskpd => todo!(),
            Mnemonic::Movmskps => todo!(),
            Mnemonic::Movntdq => todo!(),
            Mnemonic::Movntdqa => todo!(),
            Mnemonic::Movnti => todo!(),
            Mnemonic::Movntpd => todo!(),
            Mnemonic::Movntps => todo!(),
            Mnemonic::Movntq => todo!(),
            Mnemonic::Movntsd => todo!(),
            Mnemonic::Movntss => todo!(),
            Mnemonic::Movq => todo!(),
            Mnemonic::Movq2dq => todo!(),
            Mnemonic::Movshdup => todo!(),
            Mnemonic::Movsldup => todo!(),
            Mnemonic::Movss => todo!(),
            Mnemonic::Movsxd => todo!(),
            Mnemonic::Movupd => todo!(),
            Mnemonic::Movups => todo!(),
            Mnemonic::Mpsadbw => todo!(),
            Mnemonic::Mulpd => todo!(),
            Mnemonic::Mulps => todo!(),
            Mnemonic::Mulsd => todo!(),
            Mnemonic::Mulss => todo!(),
            Mnemonic::Mulx => todo!(),
            Mnemonic::Mwait => todo!(),
            Mnemonic::Mwaitx => todo!(),
            // N
            Mnemonic::Neg => self.execute_neg(instruction, state),
            Mnemonic::Nop => self.execute_nop(instruction, state),
            Mnemonic::Not => self.execute_not(instruction, state),
            // O
            Mnemonic::Or => self.execute_or(instruction, state),
            Mnemonic::Out => self.execute_out(instruction, state),
            Mnemonic::Outsb => self.execute_outsb(instruction, state),
            Mnemonic::Outsd => self.execute_outsd(instruction, state),
            Mnemonic::Outsw => self.execute_outsw(instruction, state),
            Mnemonic::Orpd => todo!(),
            Mnemonic::Orps => todo!(),
            // P
            Mnemonic::Pause => self.execute_pause(instruction, state),
            Mnemonic::Pop => self.execute_pop(instruction, state),
            Mnemonic::Popa => self.execute_popa(instruction, state),
            Mnemonic::Popcnt => self.execute_popcnt(instruction, state),
            Mnemonic::Popf => self.execute_popf(instruction, state),
            Mnemonic::Push => self.execute_push(instruction, state),
            Mnemonic::Pusha => self.execute_pusha(instruction, state),
            Mnemonic::Pushf => self.execute_pushf(instruction, state),
            Mnemonic::Pabsb => todo!(),
            Mnemonic::Pabsd => todo!(),
            Mnemonic::Pabsw => todo!(),
            Mnemonic::Packssdw => todo!(),
            Mnemonic::Packsswb => todo!(),
            Mnemonic::Packusdw => todo!(),
            Mnemonic::Packuswb => todo!(),
            Mnemonic::Paddb => todo!(),
            Mnemonic::Paddd => todo!(),
            Mnemonic::Paddq => todo!(),
            Mnemonic::Paddsb => todo!(),
            Mnemonic::Paddsw => todo!(),
            Mnemonic::Paddusb => todo!(),
            Mnemonic::Paddusw => todo!(),
            Mnemonic::Paddw => todo!(),
            Mnemonic::Palignr => todo!(),
            Mnemonic::Pand => todo!(),
            Mnemonic::Pandn => todo!(),
            Mnemonic::Pavgb => todo!(),
            Mnemonic::Pavgusb => todo!(),
            Mnemonic::Pavgw => todo!(),
            Mnemonic::Pblendvb => todo!(),
            Mnemonic::Pblendw => todo!(),
            Mnemonic::Pclmulqdq => todo!(),
            Mnemonic::Pcmpeqb => todo!(),
            Mnemonic::Pcmpeqd => todo!(),
            Mnemonic::Pcmpeqq => todo!(),
            Mnemonic::Pcmpeqw => todo!(),
            Mnemonic::Pcmpestri => todo!(),
            Mnemonic::Pcmpestri64 => todo!(),
            Mnemonic::Pcmpestrm => todo!(),
            Mnemonic::Pcmpestrm64 => todo!(),
            Mnemonic::Pcmpgtb => todo!(),
            Mnemonic::Pcmpgtd => todo!(),
            Mnemonic::Pcmpgtq => todo!(),
            Mnemonic::Pcmpgtw => todo!(),
            Mnemonic::Pcmpistri => todo!(),
            Mnemonic::Pcmpistrm => todo!(),
            Mnemonic::Pcommit => todo!(),
            Mnemonic::Pconfig => todo!(),
            Mnemonic::Pdep => todo!(),
            Mnemonic::Pext => todo!(),
            Mnemonic::Pextrb => todo!(),
            Mnemonic::Pextrd => todo!(),
            Mnemonic::Pextrq => todo!(),
            Mnemonic::Pextrw => todo!(),
            Mnemonic::Pf2id => todo!(),
            Mnemonic::Pf2iw => todo!(),
            Mnemonic::Pfacc => todo!(),
            Mnemonic::Pfadd => todo!(),
            Mnemonic::Pfcmpeq => todo!(),
            Mnemonic::Pfcmpge => todo!(),
            Mnemonic::Pfcmpgt => todo!(),
            Mnemonic::Pfmax => todo!(),
            Mnemonic::Pfmin => todo!(),
            Mnemonic::Pfmul => todo!(),
            Mnemonic::Pfnacc => todo!(),
            Mnemonic::Pfpnacc => todo!(),
            Mnemonic::Pfrcp => todo!(),
            Mnemonic::Pfrcpit1 => todo!(),
            Mnemonic::Pfrcpit2 => todo!(),
            Mnemonic::Pfrcpv => todo!(),
            Mnemonic::Pfrsqit1 => todo!(),
            Mnemonic::Pfrsqrt => todo!(),
            Mnemonic::Pfrsqrtv => todo!(),
            Mnemonic::Pfsub => todo!(),
            Mnemonic::Pfsubr => todo!(),
            Mnemonic::Phaddd => todo!(),
            Mnemonic::Phaddsw => todo!(),
            Mnemonic::Phaddw => todo!(),
            Mnemonic::Phminposuw => todo!(),
            Mnemonic::Phsubd => todo!(),
            Mnemonic::Phsubsw => todo!(),
            Mnemonic::Phsubw => todo!(),
            Mnemonic::Pi2fd => todo!(),
            Mnemonic::Pi2fw => todo!(),
            Mnemonic::Pinsrb => todo!(),
            Mnemonic::Pinsrd => todo!(),
            Mnemonic::Pinsrq => todo!(),
            Mnemonic::Pinsrw => todo!(),
            Mnemonic::Pmaddubsw => todo!(),
            Mnemonic::Pmaddwd => todo!(),
            Mnemonic::Pmaxsb => todo!(),
            Mnemonic::Pmaxsd => todo!(),
            Mnemonic::Pmaxsw => todo!(),
            Mnemonic::Pmaxub => todo!(),
            Mnemonic::Pmaxud => todo!(),
            Mnemonic::Pmaxuw => todo!(),
            Mnemonic::Pminsb => todo!(),
            Mnemonic::Pminsd => todo!(),
            Mnemonic::Pminsw => todo!(),
            Mnemonic::Pminub => todo!(),
            Mnemonic::Pminud => todo!(),
            Mnemonic::Pminuw => todo!(),
            Mnemonic::Pmovmskb => todo!(),
            Mnemonic::Pmovsxbd => todo!(),
            Mnemonic::Pmovsxbq => todo!(),
            Mnemonic::Pmovsxbw => todo!(),
            Mnemonic::Pmovsxdq => todo!(),
            Mnemonic::Pmovsxwd => todo!(),
            Mnemonic::Pmovsxwq => todo!(),
            Mnemonic::Pmovzxbd => todo!(),
            Mnemonic::Pmovzxbq => todo!(),
            Mnemonic::Pmovzxbw => todo!(),
            Mnemonic::Pmovzxdq => todo!(),
            Mnemonic::Pmovzxwd => todo!(),
            Mnemonic::Pmovzxwq => todo!(),
            Mnemonic::Pmuldq => todo!(),
            Mnemonic::Pmulhrsw => todo!(),
            Mnemonic::Pmulhrw => todo!(),
            Mnemonic::Pmulhuw => todo!(),
            Mnemonic::Pmulhw => todo!(),
            Mnemonic::Pmulld => todo!(),
            Mnemonic::Pmullw => todo!(),
            Mnemonic::Pmuludq => todo!(),
            Mnemonic::Por => todo!(),
            Mnemonic::Prefetch => todo!(),
            Mnemonic::Prefetchnta => todo!(),
            Mnemonic::Prefetcht0 => todo!(),
            Mnemonic::Prefetcht1 => todo!(),
            Mnemonic::Prefetcht2 => todo!(),
            Mnemonic::Prefetchw => todo!(),
            Mnemonic::Prefetchwt1 => todo!(),
            Mnemonic::Psadbw => todo!(),
            Mnemonic::Pshufb => todo!(),
            Mnemonic::Pshufd => todo!(),
            Mnemonic::Pshufhw => todo!(),
            Mnemonic::Pshuflw => todo!(),
            Mnemonic::Pshufw => todo!(),
            Mnemonic::Psignb => todo!(),
            Mnemonic::Psignd => todo!(),
            Mnemonic::Psignw => todo!(),
            Mnemonic::Pslld => todo!(),
            Mnemonic::Pslldq => todo!(),
            Mnemonic::Psllq => todo!(),
            Mnemonic::Psllw => todo!(),
            Mnemonic::Psrad => todo!(),
            Mnemonic::Psraw => todo!(),
            Mnemonic::Psrld => todo!(),
            Mnemonic::Psrldq => todo!(),
            Mnemonic::Psrlq => todo!(),
            Mnemonic::Psrlw => todo!(),
            Mnemonic::Psubb => todo!(),
            Mnemonic::Psubd => todo!(),
            Mnemonic::Psubq => todo!(),
            Mnemonic::Psubsb => todo!(),
            Mnemonic::Psubsw => todo!(),
            Mnemonic::Psubusb => todo!(),
            Mnemonic::Psubusw => todo!(),
            Mnemonic::Psubw => todo!(),
            Mnemonic::Pswapd => todo!(),
            Mnemonic::Ptest => todo!(),
            Mnemonic::Ptwrite => todo!(),
            Mnemonic::Punpckhbw => todo!(),
            Mnemonic::Punpckhdq => todo!(),
            Mnemonic::Punpckhqdq => todo!(),
            Mnemonic::Punpckhwd => todo!(),
            Mnemonic::Punpcklbw => todo!(),
            Mnemonic::Punpckldq => todo!(),
            Mnemonic::Punpcklqdq => todo!(),
            Mnemonic::Punpcklwd => todo!(),
            Mnemonic::Pxor => todo!(),
            // R
            Mnemonic::Rcl => self.execute_rcl(instruction, state),
            Mnemonic::Rcr => self.execute_rcr(instruction, state),
            Mnemonic::Rdmsr => self.execute_rdmsr(instruction, state),
            Mnemonic::Rdpmc => self.execute_rdpmc(instruction, state),
            Mnemonic::Rdrand => self.execute_rdrand(instruction, state),
            Mnemonic::Rdseed => self.execute_rdseed(instruction, state),
            Mnemonic::Rdtsc => self.execute_rdtsc(instruction, state),
            Mnemonic::Rdtscp => self.execute_rdtscp(instruction, state),
            Mnemonic::Ret => self.execute_ret(instruction, state),
            Mnemonic::Rol => self.execute_rol(instruction, state),
            Mnemonic::Ror => self.execute_ror(instruction, state),
            Mnemonic::Rsm => self.execute_rsm(instruction, state),
            Mnemonic::Rcpps => todo!(),
            Mnemonic::Rcpss => todo!(),
            Mnemonic::Rdfsbase => todo!(),
            Mnemonic::Rdgsbase => todo!(),
            Mnemonic::Rdpid => todo!(),
            Mnemonic::Rdpkru => todo!(),
            Mnemonic::Rdpru => todo!(),
            Mnemonic::Rdsspd => todo!(),
            Mnemonic::Rdsspq => todo!(),
            Mnemonic::Reservednop => todo!(),
            Mnemonic::Retf => todo!(),
            Mnemonic::Rorx => todo!(),
            Mnemonic::Roundpd => todo!(),
            Mnemonic::Roundps => todo!(),
            Mnemonic::Roundsd => todo!(),
            Mnemonic::Roundss => todo!(),
            Mnemonic::Rsqrtps => todo!(),
            Mnemonic::Rsqrtss => todo!(),
            Mnemonic::Rstorssp => todo!(),
            // S
            Mnemonic::Sahf => self.execute_sahf(instruction, state),
            Mnemonic::Sal => self.execute_shl(instruction, state),
            Mnemonic::Salc => self.execute_salc(instruction, state),
            Mnemonic::Sar => self.execute_sar(instruction, state),
            Mnemonic::Sbb => self.execute_sbb(instruction, state),
            Mnemonic::Scasb => self.execute_scasb(instruction, state),
            Mnemonic::Scasd => self.execute_scasd(instruction, state),
            Mnemonic::Scasq => self.execute_scasq(instruction, state),
            Mnemonic::Scasw => self.execute_scasw(instruction, state),
            Mnemonic::Sfence => self.execute_sfence(instruction, state),
            Mnemonic::Sgdt => self.execute_sgdt(instruction, state),
            Mnemonic::Shl => self.execute_shl(instruction, state),
            Mnemonic::Shr => self.execute_shr(instruction, state),
            Mnemonic::Sidt => self.execute_sidt(instruction, state),
            Mnemonic::Sldt => self.execute_sldt(instruction, state),
            Mnemonic::Smsw => self.execute_smsw(instruction, state),
            Mnemonic::Stc => self.execute_stc(instruction, state),
            Mnemonic::Std => self.execute_std(instruction, state),
            Mnemonic::Sti => self.execute_sti(instruction, state),
            Mnemonic::Stosb => self.execute_stosb(instruction, state),
            Mnemonic::Stosd => self.execute_stosd(instruction, state),
            Mnemonic::Stosq => self.execute_stosq(instruction, state),
            Mnemonic::Stosw => self.execute_stosw(instruction, state),
            Mnemonic::Str => self.execute_str(instruction, state),
            Mnemonic::Sub => self.execute_sub(instruction, state),
            Mnemonic::Swapgs => self.execute_swapgs(instruction, state),
            Mnemonic::Syscall => self.execute_syscall(instruction, state),
            Mnemonic::Sysret => self.execute_sysret(instruction, state),
            Mnemonic::Sarx => todo!(),
            Mnemonic::Saveprevssp => todo!(),
            Mnemonic::Seta => todo!(),
            Mnemonic::Setae => todo!(),
            Mnemonic::Setb => todo!(),
            Mnemonic::Setbe => todo!(),
            Mnemonic::Sete => todo!(),
            Mnemonic::Setg => todo!(),
            Mnemonic::Setge => todo!(),
            Mnemonic::Setl => todo!(),
            Mnemonic::Setle => todo!(),
            Mnemonic::Setne => todo!(),
            Mnemonic::Setno => todo!(),
            Mnemonic::Setnp => todo!(),
            Mnemonic::Setns => todo!(),
            Mnemonic::Seto => todo!(),
            Mnemonic::Setp => todo!(),
            Mnemonic::Sets => todo!(),
            Mnemonic::Setssbsy => todo!(),
            Mnemonic::Sha1msg1 => todo!(),
            Mnemonic::Sha1msg2 => todo!(),
            Mnemonic::Sha1nexte => todo!(),
            Mnemonic::Sha1rnds4 => todo!(),
            Mnemonic::Sha256msg1 => todo!(),
            Mnemonic::Sha256msg2 => todo!(),
            Mnemonic::Sha256rnds2 => todo!(),
            Mnemonic::Shld => todo!(),
            Mnemonic::Shlx => todo!(),
            Mnemonic::Shrd => todo!(),
            Mnemonic::Shrx => todo!(),
            Mnemonic::Shufpd => todo!(),
            Mnemonic::Shufps => todo!(),
            Mnemonic::Skinit => todo!(),
            Mnemonic::Slwpcb => todo!(),
            Mnemonic::Sqrtpd => todo!(),
            Mnemonic::Sqrtps => todo!(),
            Mnemonic::Sqrtsd => todo!(),
            Mnemonic::Sqrtss => todo!(),
            Mnemonic::Stac => todo!(),
            Mnemonic::Stgi => todo!(),
            Mnemonic::Stmxcsr => todo!(),
            Mnemonic::Subpd => todo!(),
            Mnemonic::Subps => todo!(),
            Mnemonic::Subsd => todo!(),
            Mnemonic::Subss => todo!(),
            Mnemonic::Sysenter => todo!(),
            Mnemonic::Sysexit => todo!(),
            // T
            Mnemonic::Test => self.execute_test(instruction, state),
            Mnemonic::T1mskc => todo!(),
            Mnemonic::Tpause => todo!(),
            Mnemonic::Tzcnt => todo!(),
            Mnemonic::Tzmsk => todo!(),
            // U
            Mnemonic::Ucomisd => todo!(),
            Mnemonic::Ucomiss => todo!(),
            Mnemonic::Ud0 => todo!(),
            Mnemonic::Ud1 => todo!(),
            Mnemonic::Ud2 => todo!(),
            Mnemonic::Umonitor => todo!(),
            Mnemonic::Umov => todo!(),
            Mnemonic::Umwait => todo!(),
            Mnemonic::Unpckhpd => todo!(),
            Mnemonic::Unpckhps => todo!(),
            Mnemonic::Unpcklpd => todo!(),
            Mnemonic::Unpcklps => todo!(),
            // V
            Mnemonic::Verr => self.execute_verr(instruction, state),
            Mnemonic::Verw => self.execute_verw(instruction, state),
            Mnemonic::V4fmaddps => todo!(),
            Mnemonic::V4fmaddss => todo!(),
            Mnemonic::V4fnmaddps => todo!(),
            Mnemonic::V4fnmaddss => todo!(),
            Mnemonic::Vaddpd => todo!(),
            Mnemonic::Vaddps => todo!(),
            Mnemonic::Vaddsd => todo!(),
            Mnemonic::Vaddss => todo!(),
            Mnemonic::Vaddsubpd => todo!(),
            Mnemonic::Vaddsubps => todo!(),
            Mnemonic::Vaesdec => todo!(),
            Mnemonic::Vaesdeclast => todo!(),
            Mnemonic::Vaesenc => todo!(),
            Mnemonic::Vaesenclast => todo!(),
            Mnemonic::Vaesimc => todo!(),
            Mnemonic::Vaeskeygenassist => todo!(),
            Mnemonic::Valignd => todo!(),
            Mnemonic::Valignq => todo!(),
            Mnemonic::Vandnpd => todo!(),
            Mnemonic::Vandnps => todo!(),
            Mnemonic::Vandpd => todo!(),
            Mnemonic::Vandps => todo!(),
            Mnemonic::Vblendmpd => todo!(),
            Mnemonic::Vblendmps => todo!(),
            Mnemonic::Vblendpd => todo!(),
            Mnemonic::Vblendps => todo!(),
            Mnemonic::Vblendvpd => todo!(),
            Mnemonic::Vblendvps => todo!(),
            Mnemonic::Vbroadcastf128 => todo!(),
            Mnemonic::Vbroadcastf32x2 => todo!(),
            Mnemonic::Vbroadcastf32x4 => todo!(),
            Mnemonic::Vbroadcastf32x8 => todo!(),
            Mnemonic::Vbroadcastf64x2 => todo!(),
            Mnemonic::Vbroadcastf64x4 => todo!(),
            Mnemonic::Vbroadcasti128 => todo!(),
            Mnemonic::Vbroadcasti32x2 => todo!(),
            Mnemonic::Vbroadcasti32x4 => todo!(),
            Mnemonic::Vbroadcasti32x8 => todo!(),
            Mnemonic::Vbroadcasti64x2 => todo!(),
            Mnemonic::Vbroadcasti64x4 => todo!(),
            Mnemonic::Vbroadcastsd => todo!(),
            Mnemonic::Vbroadcastss => todo!(),
            Mnemonic::Vcmppd => todo!(),
            Mnemonic::Vcmpps => todo!(),
            Mnemonic::Vcmpsd => todo!(),
            Mnemonic::Vcmpss => todo!(),
            Mnemonic::Vcomisd => todo!(),
            Mnemonic::Vcomiss => todo!(),
            Mnemonic::Vcompresspd => todo!(),
            Mnemonic::Vcompressps => todo!(),
            Mnemonic::Vcvtdq2pd => todo!(),
            Mnemonic::Vcvtdq2ps => todo!(),
            Mnemonic::Vcvtne2ps2bf16 => todo!(),
            Mnemonic::Vcvtneps2bf16 => todo!(),
            Mnemonic::Vcvtpd2dq => todo!(),
            Mnemonic::Vcvtpd2ps => todo!(),
            Mnemonic::Vcvtpd2qq => todo!(),
            Mnemonic::Vcvtpd2udq => todo!(),
            Mnemonic::Vcvtpd2uqq => todo!(),
            Mnemonic::Vcvtph2ps => todo!(),
            Mnemonic::Vcvtps2dq => todo!(),
            Mnemonic::Vcvtps2pd => todo!(),
            Mnemonic::Vcvtps2ph => todo!(),
            Mnemonic::Vcvtps2qq => todo!(),
            Mnemonic::Vcvtps2udq => todo!(),
            Mnemonic::Vcvtps2uqq => todo!(),
            Mnemonic::Vcvtqq2pd => todo!(),
            Mnemonic::Vcvtqq2ps => todo!(),
            Mnemonic::Vcvtsd2si => todo!(),
            Mnemonic::Vcvtsd2ss => todo!(),
            Mnemonic::Vcvtsd2usi => todo!(),
            Mnemonic::Vcvtsi2sd => todo!(),
            Mnemonic::Vcvtsi2ss => todo!(),
            Mnemonic::Vcvtss2sd => todo!(),
            Mnemonic::Vcvtss2si => todo!(),
            Mnemonic::Vcvtss2usi => todo!(),
            Mnemonic::Vcvttpd2dq => todo!(),
            Mnemonic::Vcvttpd2qq => todo!(),
            Mnemonic::Vcvttpd2udq => todo!(),
            Mnemonic::Vcvttpd2uqq => todo!(),
            Mnemonic::Vcvttps2dq => todo!(),
            Mnemonic::Vcvttps2qq => todo!(),
            Mnemonic::Vcvttps2udq => todo!(),
            Mnemonic::Vcvttps2uqq => todo!(),
            Mnemonic::Vcvttsd2si => todo!(),
            Mnemonic::Vcvttsd2usi => todo!(),
            Mnemonic::Vcvttss2si => todo!(),
            Mnemonic::Vcvttss2usi => todo!(),
            Mnemonic::Vcvtudq2pd => todo!(),
            Mnemonic::Vcvtudq2ps => todo!(),
            Mnemonic::Vcvtuqq2pd => todo!(),
            Mnemonic::Vcvtuqq2ps => todo!(),
            Mnemonic::Vcvtusi2sd => todo!(),
            Mnemonic::Vcvtusi2ss => todo!(),
            Mnemonic::Vdbpsadbw => todo!(),
            Mnemonic::Vdivpd => todo!(),
            Mnemonic::Vdivps => todo!(),
            Mnemonic::Vdivsd => todo!(),
            Mnemonic::Vdivss => todo!(),
            Mnemonic::Vdpbf16ps => todo!(),
            Mnemonic::Vdppd => todo!(),
            Mnemonic::Vdpps => todo!(),
            Mnemonic::Vexp2pd => todo!(),
            Mnemonic::Vexp2ps => todo!(),
            Mnemonic::Vexpandpd => todo!(),
            Mnemonic::Vexpandps => todo!(),
            Mnemonic::Vextractf128 => todo!(),
            Mnemonic::Vextractf32x4 => todo!(),
            Mnemonic::Vextractf32x8 => todo!(),
            Mnemonic::Vextractf64x2 => todo!(),
            Mnemonic::Vextractf64x4 => todo!(),
            Mnemonic::Vextracti128 => todo!(),
            Mnemonic::Vextracti32x4 => todo!(),
            Mnemonic::Vextracti32x8 => todo!(),
            Mnemonic::Vextracti64x2 => todo!(),
            Mnemonic::Vextracti64x4 => todo!(),
            Mnemonic::Vextractps => todo!(),
            Mnemonic::Vfixupimmpd => todo!(),
            Mnemonic::Vfixupimmps => todo!(),
            Mnemonic::Vfixupimmsd => todo!(),
            Mnemonic::Vfixupimmss => todo!(),
            Mnemonic::Vfmadd132pd => todo!(),
            Mnemonic::Vfmadd132ps => todo!(),
            Mnemonic::Vfmadd132sd => todo!(),
            Mnemonic::Vfmadd132ss => todo!(),
            Mnemonic::Vfmadd213pd => todo!(),
            Mnemonic::Vfmadd213ps => todo!(),
            Mnemonic::Vfmadd213sd => todo!(),
            Mnemonic::Vfmadd213ss => todo!(),
            Mnemonic::Vfmadd231pd => todo!(),
            Mnemonic::Vfmadd231ps => todo!(),
            Mnemonic::Vfmadd231sd => todo!(),
            Mnemonic::Vfmadd231ss => todo!(),
            Mnemonic::Vfmaddpd => todo!(),
            Mnemonic::Vfmaddps => todo!(),
            Mnemonic::Vfmaddsd => todo!(),
            Mnemonic::Vfmaddss => todo!(),
            Mnemonic::Vfmaddsub132pd => todo!(),
            Mnemonic::Vfmaddsub132ps => todo!(),
            Mnemonic::Vfmaddsub213pd => todo!(),
            Mnemonic::Vfmaddsub213ps => todo!(),
            Mnemonic::Vfmaddsub231pd => todo!(),
            Mnemonic::Vfmaddsub231ps => todo!(),
            Mnemonic::Vfmaddsubpd => todo!(),
            Mnemonic::Vfmaddsubps => todo!(),
            Mnemonic::Vfmsub132pd => todo!(),
            Mnemonic::Vfmsub132ps => todo!(),
            Mnemonic::Vfmsub132sd => todo!(),
            Mnemonic::Vfmsub132ss => todo!(),
            Mnemonic::Vfmsub213pd => todo!(),
            Mnemonic::Vfmsub213ps => todo!(),
            Mnemonic::Vfmsub213sd => todo!(),
            Mnemonic::Vfmsub213ss => todo!(),
            Mnemonic::Vfmsub231pd => todo!(),
            Mnemonic::Vfmsub231ps => todo!(),
            Mnemonic::Vfmsub231sd => todo!(),
            Mnemonic::Vfmsub231ss => todo!(),
            Mnemonic::Vfmsubadd132pd => todo!(),
            Mnemonic::Vfmsubadd132ps => todo!(),
            Mnemonic::Vfmsubadd213pd => todo!(),
            Mnemonic::Vfmsubadd213ps => todo!(),
            Mnemonic::Vfmsubadd231pd => todo!(),
            Mnemonic::Vfmsubadd231ps => todo!(),
            Mnemonic::Vfmsubaddpd => todo!(),
            Mnemonic::Vfmsubaddps => todo!(),
            Mnemonic::Vfmsubpd => todo!(),
            Mnemonic::Vfmsubps => todo!(),
            Mnemonic::Vfmsubsd => todo!(),
            Mnemonic::Vfmsubss => todo!(),
            Mnemonic::Vfnmadd132pd => todo!(),
            Mnemonic::Vfnmadd132ps => todo!(),
            Mnemonic::Vfnmadd132sd => todo!(),
            Mnemonic::Vfnmadd132ss => todo!(),
            Mnemonic::Vfnmadd213pd => todo!(),
            Mnemonic::Vfnmadd213ps => todo!(),
            Mnemonic::Vfnmadd213sd => todo!(),
            Mnemonic::Vfnmadd213ss => todo!(),
            Mnemonic::Vfnmadd231pd => todo!(),
            Mnemonic::Vfnmadd231ps => todo!(),
            Mnemonic::Vfnmadd231sd => todo!(),
            Mnemonic::Vfnmadd231ss => todo!(),
            Mnemonic::Vfnmaddpd => todo!(),
            Mnemonic::Vfnmaddps => todo!(),
            Mnemonic::Vfnmaddsd => todo!(),
            Mnemonic::Vfnmaddss => todo!(),
            Mnemonic::Vfnmsub132pd => todo!(),
            Mnemonic::Vfnmsub132ps => todo!(),
            Mnemonic::Vfnmsub132sd => todo!(),
            Mnemonic::Vfnmsub132ss => todo!(),
            Mnemonic::Vfnmsub213pd => todo!(),
            Mnemonic::Vfnmsub213ps => todo!(),
            Mnemonic::Vfnmsub213sd => todo!(),
            Mnemonic::Vfnmsub213ss => todo!(),
            Mnemonic::Vfnmsub231pd => todo!(),
            Mnemonic::Vfnmsub231ps => todo!(),
            Mnemonic::Vfnmsub231sd => todo!(),
            Mnemonic::Vfnmsub231ss => todo!(),
            Mnemonic::Vfnmsubpd => todo!(),
            Mnemonic::Vfnmsubps => todo!(),
            Mnemonic::Vfnmsubsd => todo!(),
            Mnemonic::Vfnmsubss => todo!(),
            Mnemonic::Vfpclasspd => todo!(),
            Mnemonic::Vfpclassps => todo!(),
            Mnemonic::Vfpclasssd => todo!(),
            Mnemonic::Vfpclassss => todo!(),
            Mnemonic::Vfrczpd => todo!(),
            Mnemonic::Vfrczps => todo!(),
            Mnemonic::Vfrczsd => todo!(),
            Mnemonic::Vfrczss => todo!(),
            Mnemonic::Vgatherdpd => todo!(),
            Mnemonic::Vgatherdps => todo!(),
            Mnemonic::Vgatherpf0dpd => todo!(),
            Mnemonic::Vgatherpf0dps => todo!(),
            Mnemonic::Vgatherpf0qpd => todo!(),
            Mnemonic::Vgatherpf0qps => todo!(),
            Mnemonic::Vgatherpf1dpd => todo!(),
            Mnemonic::Vgatherpf1dps => todo!(),
            Mnemonic::Vgatherpf1qpd => todo!(),
            Mnemonic::Vgatherpf1qps => todo!(),
            Mnemonic::Vgatherqpd => todo!(),
            Mnemonic::Vgatherqps => todo!(),
            Mnemonic::Vgetexppd => todo!(),
            Mnemonic::Vgetexpps => todo!(),
            Mnemonic::Vgetexpsd => todo!(),
            Mnemonic::Vgetexpss => todo!(),
            Mnemonic::Vgetmantpd => todo!(),
            Mnemonic::Vgetmantps => todo!(),
            Mnemonic::Vgetmantsd => todo!(),
            Mnemonic::Vgetmantss => todo!(),
            Mnemonic::Vgf2p8affineinvqb => todo!(),
            Mnemonic::Vgf2p8affineqb => todo!(),
            Mnemonic::Vgf2p8mulb => todo!(),
            Mnemonic::Vhaddpd => todo!(),
            Mnemonic::Vhaddps => todo!(),
            Mnemonic::Vhsubpd => todo!(),
            Mnemonic::Vhsubps => todo!(),
            Mnemonic::Vinsertf128 => todo!(),
            Mnemonic::Vinsertf32x4 => todo!(),
            Mnemonic::Vinsertf32x8 => todo!(),
            Mnemonic::Vinsertf64x2 => todo!(),
            Mnemonic::Vinsertf64x4 => todo!(),
            Mnemonic::Vinserti128 => todo!(),
            Mnemonic::Vinserti32x4 => todo!(),
            Mnemonic::Vinserti32x8 => todo!(),
            Mnemonic::Vinserti64x2 => todo!(),
            Mnemonic::Vinserti64x4 => todo!(),
            Mnemonic::Vinsertps => todo!(),
            Mnemonic::Vlddqu => todo!(),
            Mnemonic::Vldmxcsr => todo!(),
            Mnemonic::Vmaskmovdqu => todo!(),
            Mnemonic::Vmaskmovpd => todo!(),
            Mnemonic::Vmaskmovps => todo!(),
            Mnemonic::Vmaxpd => todo!(),
            Mnemonic::Vmaxps => todo!(),
            Mnemonic::Vmaxsd => todo!(),
            Mnemonic::Vmaxss => todo!(),
            Mnemonic::Vmcall => todo!(),
            Mnemonic::Vmclear => todo!(),
            Mnemonic::Vmfunc => todo!(),
            Mnemonic::Vminpd => todo!(),
            Mnemonic::Vminps => todo!(),
            Mnemonic::Vminsd => todo!(),
            Mnemonic::Vminss => todo!(),
            Mnemonic::Vmlaunch => todo!(),
            Mnemonic::Vmload => todo!(),
            Mnemonic::Vmmcall => todo!(),
            Mnemonic::Vmovapd => todo!(),
            Mnemonic::Vmovaps => todo!(),
            Mnemonic::Vmovd => todo!(),
            Mnemonic::Vmovddup => todo!(),
            Mnemonic::Vmovdqa => todo!(),
            Mnemonic::Vmovdqa32 => todo!(),
            Mnemonic::Vmovdqa64 => todo!(),
            Mnemonic::Vmovdqu => todo!(),
            Mnemonic::Vmovdqu16 => todo!(),
            Mnemonic::Vmovdqu32 => todo!(),
            Mnemonic::Vmovdqu64 => todo!(),
            Mnemonic::Vmovdqu8 => todo!(),
            Mnemonic::Vmovhlps => todo!(),
            Mnemonic::Vmovhpd => todo!(),
            Mnemonic::Vmovhps => todo!(),
            Mnemonic::Vmovlhps => todo!(),
            Mnemonic::Vmovlpd => todo!(),
            Mnemonic::Vmovlps => todo!(),
            Mnemonic::Vmovmskpd => todo!(),
            Mnemonic::Vmovmskps => todo!(),
            Mnemonic::Vmovntdq => todo!(),
            Mnemonic::Vmovntdqa => todo!(),
            Mnemonic::Vmovntpd => todo!(),
            Mnemonic::Vmovntps => todo!(),
            Mnemonic::Vmovq => todo!(),
            Mnemonic::Vmovsd => todo!(),
            Mnemonic::Vmovshdup => todo!(),
            Mnemonic::Vmovsldup => todo!(),
            Mnemonic::Vmovss => todo!(),
            Mnemonic::Vmovupd => todo!(),
            Mnemonic::Vmovups => todo!(),
            Mnemonic::Vmpsadbw => todo!(),
            Mnemonic::Vmptrld => todo!(),
            Mnemonic::Vmptrst => todo!(),
            Mnemonic::Vmread => todo!(),
            Mnemonic::Vmresume => todo!(),
            Mnemonic::Vmrun => todo!(),
            Mnemonic::Vmsave => todo!(),
            Mnemonic::Vmulpd => todo!(),
            Mnemonic::Vmulps => todo!(),
            Mnemonic::Vmulsd => todo!(),
            Mnemonic::Vmulss => todo!(),
            Mnemonic::Vmwrite => todo!(),
            Mnemonic::Vmxoff => todo!(),
            Mnemonic::Vmxon => todo!(),
            Mnemonic::Vorpd => todo!(),
            Mnemonic::Vorps => todo!(),
            Mnemonic::Vp2intersectd => todo!(),
            Mnemonic::Vp2intersectq => todo!(),
            Mnemonic::Vp4dpwssd => todo!(),
            Mnemonic::Vp4dpwssds => todo!(),
            Mnemonic::Vpabsb => todo!(),
            Mnemonic::Vpabsd => todo!(),
            Mnemonic::Vpabsq => todo!(),
            Mnemonic::Vpabsw => todo!(),
            Mnemonic::Vpackssdw => todo!(),
            Mnemonic::Vpacksswb => todo!(),
            Mnemonic::Vpackusdw => todo!(),
            Mnemonic::Vpackuswb => todo!(),
            Mnemonic::Vpaddb => todo!(),
            Mnemonic::Vpaddd => todo!(),
            Mnemonic::Vpaddq => todo!(),
            Mnemonic::Vpaddsb => todo!(),
            Mnemonic::Vpaddsw => todo!(),
            Mnemonic::Vpaddusb => todo!(),
            Mnemonic::Vpaddusw => todo!(),
            Mnemonic::Vpaddw => todo!(),
            Mnemonic::Vpalignr => todo!(),
            Mnemonic::Vpand => todo!(),
            Mnemonic::Vpandd => todo!(),
            Mnemonic::Vpandn => todo!(),
            Mnemonic::Vpandnd => todo!(),
            Mnemonic::Vpandnq => todo!(),
            Mnemonic::Vpandq => todo!(),
            Mnemonic::Vpavgb => todo!(),
            Mnemonic::Vpavgw => todo!(),
            Mnemonic::Vpblendd => todo!(),
            Mnemonic::Vpblendmb => todo!(),
            Mnemonic::Vpblendmd => todo!(),
            Mnemonic::Vpblendmq => todo!(),
            Mnemonic::Vpblendmw => todo!(),
            Mnemonic::Vpblendvb => todo!(),
            Mnemonic::Vpblendw => todo!(),
            Mnemonic::Vpbroadcastb => todo!(),
            Mnemonic::Vpbroadcastd => todo!(),
            Mnemonic::Vpbroadcastmb2q => todo!(),
            Mnemonic::Vpbroadcastmw2d => todo!(),
            Mnemonic::Vpbroadcastq => todo!(),
            Mnemonic::Vpbroadcastw => todo!(),
            Mnemonic::Vpclmulqdq => todo!(),
            Mnemonic::Vpcmov => todo!(),
            Mnemonic::Vpcmpb => todo!(),
            Mnemonic::Vpcmpd => todo!(),
            Mnemonic::Vpcmpeqb => todo!(),
            Mnemonic::Vpcmpeqd => todo!(),
            Mnemonic::Vpcmpeqq => todo!(),
            Mnemonic::Vpcmpeqw => todo!(),
            Mnemonic::Vpcmpestri => todo!(),
            Mnemonic::Vpcmpestri64 => todo!(),
            Mnemonic::Vpcmpestrm => todo!(),
            Mnemonic::Vpcmpestrm64 => todo!(),
            Mnemonic::Vpcmpgtb => todo!(),
            Mnemonic::Vpcmpgtd => todo!(),
            Mnemonic::Vpcmpgtq => todo!(),
            Mnemonic::Vpcmpgtw => todo!(),
            Mnemonic::Vpcmpistri => todo!(),
            Mnemonic::Vpcmpistrm => todo!(),
            Mnemonic::Vpcmpq => todo!(),
            Mnemonic::Vpcmpub => todo!(),
            Mnemonic::Vpcmpud => todo!(),
            Mnemonic::Vpcmpuq => todo!(),
            Mnemonic::Vpcmpuw => todo!(),
            Mnemonic::Vpcmpw => todo!(),
            Mnemonic::Vpcomb => todo!(),
            Mnemonic::Vpcomd => todo!(),
            Mnemonic::Vpcompressb => todo!(),
            Mnemonic::Vpcompressd => todo!(),
            Mnemonic::Vpcompressq => todo!(),
            Mnemonic::Vpcompressw => todo!(),
            Mnemonic::Vpcomq => todo!(),
            Mnemonic::Vpcomub => todo!(),
            Mnemonic::Vpcomud => todo!(),
            Mnemonic::Vpcomuq => todo!(),
            Mnemonic::Vpcomuw => todo!(),
            Mnemonic::Vpcomw => todo!(),
            Mnemonic::Vpconflictd => todo!(),
            Mnemonic::Vpconflictq => todo!(),
            Mnemonic::Vpdpbusd => todo!(),
            Mnemonic::Vpdpbusds => todo!(),
            Mnemonic::Vpdpwssd => todo!(),
            Mnemonic::Vpdpwssds => todo!(),
            Mnemonic::Vperm2f128 => todo!(),
            Mnemonic::Vperm2i128 => todo!(),
            Mnemonic::Vpermb => todo!(),
            Mnemonic::Vpermd => todo!(),
            Mnemonic::Vpermi2b => todo!(),
            Mnemonic::Vpermi2d => todo!(),
            Mnemonic::Vpermi2pd => todo!(),
            Mnemonic::Vpermi2ps => todo!(),
            Mnemonic::Vpermi2q => todo!(),
            Mnemonic::Vpermi2w => todo!(),
            Mnemonic::Vpermil2pd => todo!(),
            Mnemonic::Vpermil2ps => todo!(),
            Mnemonic::Vpermilpd => todo!(),
            Mnemonic::Vpermilps => todo!(),
            Mnemonic::Vpermpd => todo!(),
            Mnemonic::Vpermps => todo!(),
            Mnemonic::Vpermq => todo!(),
            Mnemonic::Vpermt2b => todo!(),
            Mnemonic::Vpermt2d => todo!(),
            Mnemonic::Vpermt2pd => todo!(),
            Mnemonic::Vpermt2ps => todo!(),
            Mnemonic::Vpermt2q => todo!(),
            Mnemonic::Vpermt2w => todo!(),
            Mnemonic::Vpermw => todo!(),
            Mnemonic::Vpexpandb => todo!(),
            Mnemonic::Vpexpandd => todo!(),
            Mnemonic::Vpexpandq => todo!(),
            Mnemonic::Vpexpandw => todo!(),
            Mnemonic::Vpextrb => todo!(),
            Mnemonic::Vpextrd => todo!(),
            Mnemonic::Vpextrq => todo!(),
            Mnemonic::Vpextrw => todo!(),
            Mnemonic::Vpgatherdd => todo!(),
            Mnemonic::Vpgatherdq => todo!(),
            Mnemonic::Vpgatherqd => todo!(),
            Mnemonic::Vpgatherqq => todo!(),
            Mnemonic::Vphaddbd => todo!(),
            Mnemonic::Vphaddbq => todo!(),
            Mnemonic::Vphaddbw => todo!(),
            Mnemonic::Vphaddd => todo!(),
            Mnemonic::Vphadddq => todo!(),
            Mnemonic::Vphaddsw => todo!(),
            Mnemonic::Vphaddubd => todo!(),
            Mnemonic::Vphaddubq => todo!(),
            Mnemonic::Vphaddubw => todo!(),
            Mnemonic::Vphaddudq => todo!(),
            Mnemonic::Vphadduwd => todo!(),
            Mnemonic::Vphadduwq => todo!(),
            Mnemonic::Vphaddw => todo!(),
            Mnemonic::Vphaddwd => todo!(),
            Mnemonic::Vphaddwq => todo!(),
            Mnemonic::Vphminposuw => todo!(),
            Mnemonic::Vphsubbw => todo!(),
            Mnemonic::Vphsubd => todo!(),
            Mnemonic::Vphsubdq => todo!(),
            Mnemonic::Vphsubsw => todo!(),
            Mnemonic::Vphsubw => todo!(),
            Mnemonic::Vphsubwd => todo!(),
            Mnemonic::Vpinsrb => todo!(),
            Mnemonic::Vpinsrd => todo!(),
            Mnemonic::Vpinsrq => todo!(),
            Mnemonic::Vpinsrw => todo!(),
            Mnemonic::Vplzcntd => todo!(),
            Mnemonic::Vplzcntq => todo!(),
            Mnemonic::Vpmacsdd => todo!(),
            Mnemonic::Vpmacsdqh => todo!(),
            Mnemonic::Vpmacsdql => todo!(),
            Mnemonic::Vpmacssdd => todo!(),
            Mnemonic::Vpmacssdqh => todo!(),
            Mnemonic::Vpmacssdql => todo!(),
            Mnemonic::Vpmacsswd => todo!(),
            Mnemonic::Vpmacssww => todo!(),
            Mnemonic::Vpmacswd => todo!(),
            Mnemonic::Vpmacsww => todo!(),
            Mnemonic::Vpmadcsswd => todo!(),
            Mnemonic::Vpmadcswd => todo!(),
            Mnemonic::Vpmadd52huq => todo!(),
            Mnemonic::Vpmadd52luq => todo!(),
            Mnemonic::Vpmaddubsw => todo!(),
            Mnemonic::Vpmaddwd => todo!(),
            Mnemonic::Vpmaskmovd => todo!(),
            Mnemonic::Vpmaskmovq => todo!(),
            Mnemonic::Vpmaxsb => todo!(),
            Mnemonic::Vpmaxsd => todo!(),
            Mnemonic::Vpmaxsq => todo!(),
            Mnemonic::Vpmaxsw => todo!(),
            Mnemonic::Vpmaxub => todo!(),
            Mnemonic::Vpmaxud => todo!(),
            Mnemonic::Vpmaxuq => todo!(),
            Mnemonic::Vpmaxuw => todo!(),
            Mnemonic::Vpminsb => todo!(),
            Mnemonic::Vpminsd => todo!(),
            Mnemonic::Vpminsq => todo!(),
            Mnemonic::Vpminsw => todo!(),
            Mnemonic::Vpminub => todo!(),
            Mnemonic::Vpminud => todo!(),
            Mnemonic::Vpminuq => todo!(),
            Mnemonic::Vpminuw => todo!(),
            Mnemonic::Vpmovb2m => todo!(),
            Mnemonic::Vpmovd2m => todo!(),
            Mnemonic::Vpmovdb => todo!(),
            Mnemonic::Vpmovdw => todo!(),
            Mnemonic::Vpmovm2b => todo!(),
            Mnemonic::Vpmovm2d => todo!(),
            Mnemonic::Vpmovm2q => todo!(),
            Mnemonic::Vpmovm2w => todo!(),
            Mnemonic::Vpmovmskb => todo!(),
            Mnemonic::Vpmovq2m => todo!(),
            Mnemonic::Vpmovqb => todo!(),
            Mnemonic::Vpmovqd => todo!(),
            Mnemonic::Vpmovqw => todo!(),
            Mnemonic::Vpmovsdb => todo!(),
            Mnemonic::Vpmovsdw => todo!(),
            Mnemonic::Vpmovsqb => todo!(),
            Mnemonic::Vpmovsqd => todo!(),
            Mnemonic::Vpmovsqw => todo!(),
            Mnemonic::Vpmovswb => todo!(),
            Mnemonic::Vpmovsxbd => todo!(),
            Mnemonic::Vpmovsxbq => todo!(),
            Mnemonic::Vpmovsxbw => todo!(),
            Mnemonic::Vpmovsxdq => todo!(),
            Mnemonic::Vpmovsxwd => todo!(),
            Mnemonic::Vpmovsxwq => todo!(),
            Mnemonic::Vpmovusdb => todo!(),
            Mnemonic::Vpmovusdw => todo!(),
            Mnemonic::Vpmovusqb => todo!(),
            Mnemonic::Vpmovusqd => todo!(),
            Mnemonic::Vpmovusqw => todo!(),
            Mnemonic::Vpmovuswb => todo!(),
            Mnemonic::Vpmovw2m => todo!(),
            Mnemonic::Vpmovwb => todo!(),
            Mnemonic::Vpmovzxbd => todo!(),
            Mnemonic::Vpmovzxbq => todo!(),
            Mnemonic::Vpmovzxbw => todo!(),
            Mnemonic::Vpmovzxdq => todo!(),
            Mnemonic::Vpmovzxwd => todo!(),
            Mnemonic::Vpmovzxwq => todo!(),
            Mnemonic::Vpmuldq => todo!(),
            Mnemonic::Vpmulhrsw => todo!(),
            Mnemonic::Vpmulhuw => todo!(),
            Mnemonic::Vpmulhw => todo!(),
            Mnemonic::Vpmulld => todo!(),
            Mnemonic::Vpmullq => todo!(),
            Mnemonic::Vpmullw => todo!(),
            Mnemonic::Vpmultishiftqb => todo!(),
            Mnemonic::Vpmuludq => todo!(),
            Mnemonic::Vpopcntb => todo!(),
            Mnemonic::Vpopcntd => todo!(),
            Mnemonic::Vpopcntq => todo!(),
            Mnemonic::Vpopcntw => todo!(),
            Mnemonic::Vpor => todo!(),
            Mnemonic::Vpord => todo!(),
            Mnemonic::Vporq => todo!(),
            Mnemonic::Vpperm => todo!(),
            Mnemonic::Vprold => todo!(),
            Mnemonic::Vprolq => todo!(),
            Mnemonic::Vprolvd => todo!(),
            Mnemonic::Vprolvq => todo!(),
            Mnemonic::Vprord => todo!(),
            Mnemonic::Vprorq => todo!(),
            Mnemonic::Vprorvd => todo!(),
            Mnemonic::Vprorvq => todo!(),
            Mnemonic::Vprotb => todo!(),
            Mnemonic::Vprotd => todo!(),
            Mnemonic::Vprotq => todo!(),
            Mnemonic::Vprotw => todo!(),
            Mnemonic::Vpsadbw => todo!(),
            Mnemonic::Vpscatterdd => todo!(),
            Mnemonic::Vpscatterdq => todo!(),
            Mnemonic::Vpscatterqd => todo!(),
            Mnemonic::Vpscatterqq => todo!(),
            Mnemonic::Vpshab => todo!(),
            Mnemonic::Vpshad => todo!(),
            Mnemonic::Vpshaq => todo!(),
            Mnemonic::Vpshaw => todo!(),
            Mnemonic::Vpshlb => todo!(),
            Mnemonic::Vpshld => todo!(),
            Mnemonic::Vpshldd => todo!(),
            Mnemonic::Vpshldq => todo!(),
            Mnemonic::Vpshldvd => todo!(),
            Mnemonic::Vpshldvq => todo!(),
            Mnemonic::Vpshldvw => todo!(),
            Mnemonic::Vpshldw => todo!(),
            Mnemonic::Vpshlq => todo!(),
            Mnemonic::Vpshlw => todo!(),
            Mnemonic::Vpshrdd => todo!(),
            Mnemonic::Vpshrdq => todo!(),
            Mnemonic::Vpshrdvd => todo!(),
            Mnemonic::Vpshrdvq => todo!(),
            Mnemonic::Vpshrdvw => todo!(),
            Mnemonic::Vpshrdw => todo!(),
            Mnemonic::Vpshufb => todo!(),
            Mnemonic::Vpshufbitqmb => todo!(),
            Mnemonic::Vpshufd => todo!(),
            Mnemonic::Vpshufhw => todo!(),
            Mnemonic::Vpshuflw => todo!(),
            Mnemonic::Vpsignb => todo!(),
            Mnemonic::Vpsignd => todo!(),
            Mnemonic::Vpsignw => todo!(),
            Mnemonic::Vpslld => todo!(),
            Mnemonic::Vpslldq => todo!(),
            Mnemonic::Vpsllq => todo!(),
            Mnemonic::Vpsllvd => todo!(),
            Mnemonic::Vpsllvq => todo!(),
            Mnemonic::Vpsllvw => todo!(),
            Mnemonic::Vpsllw => todo!(),
            Mnemonic::Vpsrad => todo!(),
            Mnemonic::Vpsraq => todo!(),
            Mnemonic::Vpsravd => todo!(),
            Mnemonic::Vpsravq => todo!(),
            Mnemonic::Vpsravw => todo!(),
            Mnemonic::Vpsraw => todo!(),
            Mnemonic::Vpsrld => todo!(),
            Mnemonic::Vpsrldq => todo!(),
            Mnemonic::Vpsrlq => todo!(),
            Mnemonic::Vpsrlvd => todo!(),
            Mnemonic::Vpsrlvq => todo!(),
            Mnemonic::Vpsrlvw => todo!(),
            Mnemonic::Vpsrlw => todo!(),
            Mnemonic::Vpsubb => todo!(),
            Mnemonic::Vpsubd => todo!(),
            Mnemonic::Vpsubq => todo!(),
            Mnemonic::Vpsubsb => todo!(),
            Mnemonic::Vpsubsw => todo!(),
            Mnemonic::Vpsubusb => todo!(),
            Mnemonic::Vpsubusw => todo!(),
            Mnemonic::Vpsubw => todo!(),
            Mnemonic::Vpternlogd => todo!(),
            Mnemonic::Vpternlogq => todo!(),
            Mnemonic::Vptest => todo!(),
            Mnemonic::Vptestmb => todo!(),
            Mnemonic::Vptestmd => todo!(),
            Mnemonic::Vptestmq => todo!(),
            Mnemonic::Vptestmw => todo!(),
            Mnemonic::Vptestnmb => todo!(),
            Mnemonic::Vptestnmd => todo!(),
            Mnemonic::Vptestnmq => todo!(),
            Mnemonic::Vptestnmw => todo!(),
            Mnemonic::Vpunpckhbw => todo!(),
            Mnemonic::Vpunpckhdq => todo!(),
            Mnemonic::Vpunpckhqdq => todo!(),
            Mnemonic::Vpunpckhwd => todo!(),
            Mnemonic::Vpunpcklbw => todo!(),
            Mnemonic::Vpunpckldq => todo!(),
            Mnemonic::Vpunpcklqdq => todo!(),
            Mnemonic::Vpunpcklwd => todo!(),
            Mnemonic::Vpxor => todo!(),
            Mnemonic::Vpxord => todo!(),
            Mnemonic::Vpxorq => todo!(),
            Mnemonic::Vrangepd => todo!(),
            Mnemonic::Vrangeps => todo!(),
            Mnemonic::Vrangesd => todo!(),
            Mnemonic::Vrangess => todo!(),
            Mnemonic::Vrcp14pd => todo!(),
            Mnemonic::Vrcp14ps => todo!(),
            Mnemonic::Vrcp14sd => todo!(),
            Mnemonic::Vrcp14ss => todo!(),
            Mnemonic::Vrcp28pd => todo!(),
            Mnemonic::Vrcp28ps => todo!(),
            Mnemonic::Vrcp28sd => todo!(),
            Mnemonic::Vrcp28ss => todo!(),
            Mnemonic::Vrcpps => todo!(),
            Mnemonic::Vrcpss => todo!(),
            Mnemonic::Vreducepd => todo!(),
            Mnemonic::Vreduceps => todo!(),
            Mnemonic::Vreducesd => todo!(),
            Mnemonic::Vreducess => todo!(),
            Mnemonic::Vrndscalepd => todo!(),
            Mnemonic::Vrndscaleps => todo!(),
            Mnemonic::Vrndscalesd => todo!(),
            Mnemonic::Vrndscaless => todo!(),
            Mnemonic::Vroundpd => todo!(),
            Mnemonic::Vroundps => todo!(),
            Mnemonic::Vroundsd => todo!(),
            Mnemonic::Vroundss => todo!(),
            Mnemonic::Vrsqrt14pd => todo!(),
            Mnemonic::Vrsqrt14ps => todo!(),
            Mnemonic::Vrsqrt14sd => todo!(),
            Mnemonic::Vrsqrt14ss => todo!(),
            Mnemonic::Vrsqrt28pd => todo!(),
            Mnemonic::Vrsqrt28ps => todo!(),
            Mnemonic::Vrsqrt28sd => todo!(),
            Mnemonic::Vrsqrt28ss => todo!(),
            Mnemonic::Vrsqrtps => todo!(),
            Mnemonic::Vrsqrtss => todo!(),
            Mnemonic::Vscalefpd => todo!(),
            Mnemonic::Vscalefps => todo!(),
            Mnemonic::Vscalefsd => todo!(),
            Mnemonic::Vscalefss => todo!(),
            Mnemonic::Vscatterdpd => todo!(),
            Mnemonic::Vscatterdps => todo!(),
            Mnemonic::Vscatterpf0dpd => todo!(),
            Mnemonic::Vscatterpf0dps => todo!(),
            Mnemonic::Vscatterpf0qpd => todo!(),
            Mnemonic::Vscatterpf0qps => todo!(),
            Mnemonic::Vscatterpf1dpd => todo!(),
            Mnemonic::Vscatterpf1dps => todo!(),
            Mnemonic::Vscatterpf1qpd => todo!(),
            Mnemonic::Vscatterpf1qps => todo!(),
            Mnemonic::Vscatterqpd => todo!(),
            Mnemonic::Vscatterqps => todo!(),
            Mnemonic::Vshuff32x4 => todo!(),
            Mnemonic::Vshuff64x2 => todo!(),
            Mnemonic::Vshufi32x4 => todo!(),
            Mnemonic::Vshufi64x2 => todo!(),
            Mnemonic::Vshufpd => todo!(),
            Mnemonic::Vshufps => todo!(),
            Mnemonic::Vsqrtpd => todo!(),
            Mnemonic::Vsqrtps => todo!(),
            Mnemonic::Vsqrtsd => todo!(),
            Mnemonic::Vsqrtss => todo!(),
            Mnemonic::Vstmxcsr => todo!(),
            Mnemonic::Vsubpd => todo!(),
            Mnemonic::Vsubps => todo!(),
            Mnemonic::Vsubsd => todo!(),
            Mnemonic::Vsubss => todo!(),
            Mnemonic::Vtestpd => todo!(),
            Mnemonic::Vtestps => todo!(),
            Mnemonic::Vucomisd => todo!(),
            Mnemonic::Vucomiss => todo!(),
            Mnemonic::Vunpckhpd => todo!(),
            Mnemonic::Vunpckhps => todo!(),
            Mnemonic::Vunpcklpd => todo!(),
            Mnemonic::Vunpcklps => todo!(),
            Mnemonic::Vxorpd => todo!(),
            Mnemonic::Vxorps => todo!(),
            Mnemonic::Vzeroall => todo!(),
            Mnemonic::Vzeroupper => todo!(),
            // W
            Mnemonic::Wbinvd => self.execute_wbinvd(instruction, state),
            Mnemonic::Wrmsr => self.execute_wrmsr(instruction, state),
            Mnemonic::Wait => todo!(),
            Mnemonic::Wbnoinvd => todo!(),
            Mnemonic::Wrfsbase => todo!(),
            Mnemonic::Wrgsbase => todo!(),
            Mnemonic::Wrpkru => todo!(),
            Mnemonic::Wrssd => todo!(),
            Mnemonic::Wrssq => todo!(),
            Mnemonic::Wrussd => todo!(),
            Mnemonic::Wrussq => todo!(),
            // X
            Mnemonic::Xchg => self.execute_xchg(instruction, state),
            Mnemonic::Xlatb => self.execute_xlat(instruction, state),
            Mnemonic::Xor => self.execute_xor(instruction, state),
            Mnemonic::Xabort => todo!(),
            Mnemonic::Xadd => todo!(),
            Mnemonic::Xbegin => todo!(),
            Mnemonic::Xbts => todo!(),
            Mnemonic::Xcryptcbc => todo!(),
            Mnemonic::Xcryptcfb => todo!(),
            Mnemonic::Xcryptctr => todo!(),
            Mnemonic::Xcryptecb => todo!(),
            Mnemonic::Xcryptofb => todo!(),
            Mnemonic::Xend => todo!(),
            Mnemonic::Xgetbv => todo!(),
            Mnemonic::Xorpd => todo!(),
            Mnemonic::Xorps => todo!(),
            Mnemonic::Xrstor => todo!(),
            Mnemonic::Xrstor64 => todo!(),
            Mnemonic::Xrstors => todo!(),
            Mnemonic::Xrstors64 => todo!(),
            Mnemonic::Xsave => todo!(),
            Mnemonic::Xsave64 => todo!(),
            Mnemonic::Xsavec => todo!(),
            Mnemonic::Xsavec64 => todo!(),
            Mnemonic::Xsaveopt => todo!(),
            Mnemonic::Xsaveopt64 => todo!(),
            Mnemonic::Xsaves => todo!(),
            Mnemonic::Xsaves64 => todo!(),
            Mnemonic::Xsetbv => todo!(),
            Mnemonic::Xsha1 => todo!(),
            Mnemonic::Xsha256 => todo!(),
            Mnemonic::Xstore => todo!(),
            Mnemonic::Xtest => todo!(),
            Mnemonic::Rmpadjust => todo!(),
            Mnemonic::Rmpupdate => todo!(),
            Mnemonic::Psmash => todo!(),
            Mnemonic::Pvalidate => todo!(),
            Mnemonic::Serialize => todo!(),
            Mnemonic::Xsusldtrk => todo!(),
            Mnemonic::Xresldtrk => todo!(),
            Mnemonic::Invlpgb => todo!(),
            Mnemonic::Tlbsync => todo!(),
            Mnemonic::Vmgexit => todo!(),
            Mnemonic::Getsecq => todo!(),
            Mnemonic::Sysexitq => todo!(),
            Mnemonic::Ldtilecfg => todo!(),
            Mnemonic::Tilerelease => todo!(),
            Mnemonic::Sttilecfg => todo!(),
            Mnemonic::Tilezero => todo!(),
            Mnemonic::Tileloaddt1 => todo!(),
            Mnemonic::Tilestored => todo!(),
            Mnemonic::Tileloadd => todo!(),
            Mnemonic::Tdpbf16ps => todo!(),
            Mnemonic::Tdpbuud => todo!(),
            Mnemonic::Tdpbusd => todo!(),
            Mnemonic::Tdpbsud => todo!(),
            Mnemonic::Tdpbssd => todo!(),
            Mnemonic::Sysretq => todo!(),
            Mnemonic::Fnstdw => todo!(),
            Mnemonic::Fnstsg => todo!(),
            Mnemonic::Rdshr => todo!(),
            Mnemonic::Wrshr => todo!(),
            Mnemonic::Smint => todo!(),
            Mnemonic::Dmint => todo!(),
            Mnemonic::Rdm => todo!(),
            Mnemonic::Svdc => todo!(),
            Mnemonic::Rsdc => todo!(),
            Mnemonic::Svldt => todo!(),
            Mnemonic::Rsldt => todo!(),
            Mnemonic::Svts => todo!(),
            Mnemonic::Rsts => todo!(),
            Mnemonic::Bb0_reset => todo!(),
            Mnemonic::Bb1_reset => todo!(),
            Mnemonic::Cpu_write => todo!(),
            Mnemonic::Cpu_read => todo!(),
            Mnemonic::Altinst => todo!(),
            Mnemonic::Paveb => todo!(),
            Mnemonic::Paddsiw => todo!(),
            Mnemonic::Pmagw => todo!(),
            Mnemonic::Pdistib => todo!(),
            Mnemonic::Psubsiw => todo!(),
            Mnemonic::Pmvzb => todo!(),
            Mnemonic::Pmvnzb => todo!(),
            Mnemonic::Pmvlzb => todo!(),
            Mnemonic::Pmvgezb => todo!(),
            Mnemonic::Pmulhriw => todo!(),
            Mnemonic::Pmachriw => todo!(),
            Mnemonic::Ftstp => todo!(),
            Mnemonic::Frint2 => todo!(),
            Mnemonic::Frichop => todo!(),
            Mnemonic::Frinear => todo!(),
            Mnemonic::Undoc => todo!(),
            Mnemonic::Tdcall => todo!(),
            Mnemonic::Seamret => todo!(),
            Mnemonic::Seamops => todo!(),
            Mnemonic::Seamcall => todo!(),
            Mnemonic::Aesencwide128kl => todo!(),
            Mnemonic::Aesdecwide128kl => todo!(),
            Mnemonic::Aesencwide256kl => todo!(),
            Mnemonic::Aesdecwide256kl => todo!(),
            Mnemonic::Loadiwkey => todo!(),
            Mnemonic::Aesenc128kl => todo!(),
            Mnemonic::Aesdec128kl => todo!(),
            Mnemonic::Aesenc256kl => todo!(),
            Mnemonic::Aesdec256kl => todo!(),
            Mnemonic::Encodekey128 => todo!(),
            Mnemonic::Encodekey256 => todo!(),
            Mnemonic::Pushad => todo!(),
            Mnemonic::Popad => todo!(),
            Mnemonic::Pushfd => todo!(),
            Mnemonic::Pushfq => todo!(),
            Mnemonic::Popfd => todo!(),
            Mnemonic::Popfq => todo!(),
            Mnemonic::Iretd => todo!(),
            Mnemonic::Iretq => todo!(),
            Mnemonic::Int3 => todo!(),
            Mnemonic::Uiret => todo!(),
            Mnemonic::Testui => todo!(),
            Mnemonic::Stui => todo!(),
            Mnemonic::Senduipi => todo!(),
            Mnemonic::Hreset => todo!(),
            Mnemonic::Ccs_hash => todo!(),
            Mnemonic::Ccs_encrypt => todo!(),
            Mnemonic::Lkgs => todo!(),
            Mnemonic::Eretu => todo!(),
            Mnemonic::Erets => todo!(),
            Mnemonic::Storeall => todo!(),
            Mnemonic::Vaddph => todo!(),
            Mnemonic::Vaddsh => todo!(),
            Mnemonic::Vcmpph => todo!(),
            Mnemonic::Vcmpsh => todo!(),
            Mnemonic::Vcomish => todo!(),
            Mnemonic::Vcvtdq2ph => todo!(),
            Mnemonic::Vcvtpd2ph => todo!(),
            Mnemonic::Vcvtph2dq => todo!(),
            Mnemonic::Vcvtph2pd => todo!(),
            Mnemonic::Vcvtph2psx => todo!(),
            Mnemonic::Vcvtph2qq => todo!(),
            Mnemonic::Vcvtph2udq => todo!(),
            Mnemonic::Vcvtph2uqq => todo!(),
            Mnemonic::Vcvtph2uw => todo!(),
            Mnemonic::Vcvtph2w => todo!(),
            Mnemonic::Vcvtps2phx => todo!(),
            Mnemonic::Vcvtqq2ph => todo!(),
            Mnemonic::Vcvtsd2sh => todo!(),
            Mnemonic::Vcvtsh2sd => todo!(),
            Mnemonic::Vcvtsh2si => todo!(),
            Mnemonic::Vcvtsh2ss => todo!(),
            Mnemonic::Vcvtsh2usi => todo!(),
            Mnemonic::Vcvtsi2sh => todo!(),
            Mnemonic::Vcvtss2sh => todo!(),
            Mnemonic::Vcvttph2dq => todo!(),
            Mnemonic::Vcvttph2qq => todo!(),
            Mnemonic::Vcvttph2udq => todo!(),
            Mnemonic::Vcvttph2uqq => todo!(),
            Mnemonic::Vcvttph2uw => todo!(),
            Mnemonic::Vcvttph2w => todo!(),
            Mnemonic::Vcvttsh2si => todo!(),
            Mnemonic::Vcvttsh2usi => todo!(),
            Mnemonic::Vcvtudq2ph => todo!(),
            Mnemonic::Vcvtuqq2ph => todo!(),
            Mnemonic::Vcvtusi2sh => todo!(),
            Mnemonic::Vcvtuw2ph => todo!(),
            Mnemonic::Vcvtw2ph => todo!(),
            Mnemonic::Vdivph => todo!(),
            Mnemonic::Vdivsh => todo!(),
            Mnemonic::Vfcmaddcph => todo!(),
            Mnemonic::Vfmaddcph => todo!(),
            Mnemonic::Vfcmaddcsh => todo!(),
            Mnemonic::Vfmaddcsh => todo!(),
            Mnemonic::Vfcmulcph => todo!(),
            Mnemonic::Vfmulcph => todo!(),
            Mnemonic::Vfcmulcsh => todo!(),
            Mnemonic::Vfmulcsh => todo!(),
            Mnemonic::Vfmaddsub132ph => todo!(),
            Mnemonic::Vfmaddsub213ph => todo!(),
            Mnemonic::Vfmaddsub231ph => todo!(),
            Mnemonic::Vfmsubadd132ph => todo!(),
            Mnemonic::Vfmsubadd213ph => todo!(),
            Mnemonic::Vfmsubadd231ph => todo!(),
            Mnemonic::Vfmadd132ph => todo!(),
            Mnemonic::Vfmadd213ph => todo!(),
            Mnemonic::Vfmadd231ph => todo!(),
            Mnemonic::Vfnmadd132ph => todo!(),
            Mnemonic::Vfnmadd213ph => todo!(),
            Mnemonic::Vfnmadd231ph => todo!(),
            Mnemonic::Vfmadd132sh => todo!(),
            Mnemonic::Vfmadd213sh => todo!(),
            Mnemonic::Vfmadd231sh => todo!(),
            Mnemonic::Vfnmadd132sh => todo!(),
            Mnemonic::Vfnmadd213sh => todo!(),
            Mnemonic::Vfnmadd231sh => todo!(),
            Mnemonic::Vfmsub132ph => todo!(),
            Mnemonic::Vfmsub213ph => todo!(),
            Mnemonic::Vfmsub231ph => todo!(),
            Mnemonic::Vfnmsub132ph => todo!(),
            Mnemonic::Vfnmsub213ph => todo!(),
            Mnemonic::Vfnmsub231ph => todo!(),
            Mnemonic::Vfmsub132sh => todo!(),
            Mnemonic::Vfmsub213sh => todo!(),
            Mnemonic::Vfmsub231sh => todo!(),
            Mnemonic::Vfnmsub132sh => todo!(),
            Mnemonic::Vfnmsub213sh => todo!(),
            Mnemonic::Vfnmsub231sh => todo!(),
            Mnemonic::Vfpclassph => todo!(),
            Mnemonic::Vfpclasssh => todo!(),
            Mnemonic::Vgetexpph => todo!(),
            Mnemonic::Vgetexpsh => todo!(),
            Mnemonic::Vgetmantph => todo!(),
            Mnemonic::Vgetmantsh => todo!(),
            Mnemonic::Vmaxph => todo!(),
            Mnemonic::Vmaxsh => todo!(),
            Mnemonic::Vminph => todo!(),
            Mnemonic::Vminsh => todo!(),
            Mnemonic::Vmovsh => todo!(),
            Mnemonic::Vmovw => todo!(),
            Mnemonic::Vmulph => todo!(),
            Mnemonic::Vmulsh => todo!(),
            Mnemonic::Vrcpph => todo!(),
            Mnemonic::Vrcpsh => todo!(),
            Mnemonic::Vreduceph => todo!(),
            Mnemonic::Vreducesh => todo!(),
            Mnemonic::Vrndscaleph => todo!(),
            Mnemonic::Vrndscalesh => todo!(),
            Mnemonic::Vrsqrtph => todo!(),
            Mnemonic::Vrsqrtsh => todo!(),
            Mnemonic::Vscalefph => todo!(),
            Mnemonic::Vscalefsh => todo!(),
            Mnemonic::Vsqrtph => todo!(),
            Mnemonic::Vsqrtsh => todo!(),
            Mnemonic::Vsubph => todo!(),
            Mnemonic::Vsubsh => todo!(),
            Mnemonic::Vucomish => todo!(),
            Mnemonic::Rdudbg => todo!(),
            Mnemonic::Wrudbg => todo!(),
            Mnemonic::Clevict0 => todo!(),
            Mnemonic::Clevict1 => todo!(),
            Mnemonic::Delay => todo!(),
            Mnemonic::Jknzd => todo!(),
            Mnemonic::Jkzd => todo!(),
            Mnemonic::Kand => todo!(),
            Mnemonic::Kandn => todo!(),
            Mnemonic::Kandnr => todo!(),
            Mnemonic::Kconcath => todo!(),
            Mnemonic::Kconcatl => todo!(),
            Mnemonic::Kextract => todo!(),
            Mnemonic::Kmerge2l1h => todo!(),
            Mnemonic::Kmerge2l1l => todo!(),
            Mnemonic::Kmov => todo!(),
            Mnemonic::Knot => todo!(),
            Mnemonic::Kor => todo!(),
            Mnemonic::Kortest => todo!(),
            Mnemonic::Kxnor => todo!(),
            Mnemonic::Kxor => todo!(),
            Mnemonic::Spflt => todo!(),
            Mnemonic::Tzcnti => todo!(),
            Mnemonic::Vaddnpd => todo!(),
            Mnemonic::Vaddnps => todo!(),
            Mnemonic::Vaddsetsps => todo!(),
            Mnemonic::Vcvtfxpntdq2ps => todo!(),
            Mnemonic::Vcvtfxpntpd2dq => todo!(),
            Mnemonic::Vcvtfxpntpd2udq => todo!(),
            Mnemonic::Vcvtfxpntps2dq => todo!(),
            Mnemonic::Vcvtfxpntps2udq => todo!(),
            Mnemonic::Vcvtfxpntudq2ps => todo!(),
            Mnemonic::Vexp223ps => todo!(),
            Mnemonic::Vfixupnanpd => todo!(),
            Mnemonic::Vfixupnanps => todo!(),
            Mnemonic::Vfmadd233ps => todo!(),
            Mnemonic::Vgatherpf0hintdpd => todo!(),
            Mnemonic::Vgatherpf0hintdps => todo!(),
            Mnemonic::Vgmaxabsps => todo!(),
            Mnemonic::Vgmaxpd => todo!(),
            Mnemonic::Vgmaxps => todo!(),
            Mnemonic::Vgminpd => todo!(),
            Mnemonic::Vgminps => todo!(),
            Mnemonic::Vloadunpackhd => todo!(),
            Mnemonic::Vloadunpackhpd => todo!(),
            Mnemonic::Vloadunpackhps => todo!(),
            Mnemonic::Vloadunpackhq => todo!(),
            Mnemonic::Vloadunpackld => todo!(),
            Mnemonic::Vloadunpacklpd => todo!(),
            Mnemonic::Vloadunpacklps => todo!(),
            Mnemonic::Vloadunpacklq => todo!(),
            Mnemonic::Vlog2ps => todo!(),
            Mnemonic::Vmovnrapd => todo!(),
            Mnemonic::Vmovnraps => todo!(),
            Mnemonic::Vmovnrngoapd => todo!(),
            Mnemonic::Vmovnrngoaps => todo!(),
            Mnemonic::Vpackstorehd => todo!(),
            Mnemonic::Vpackstorehpd => todo!(),
            Mnemonic::Vpackstorehps => todo!(),
            Mnemonic::Vpackstorehq => todo!(),
            Mnemonic::Vpackstoreld => todo!(),
            Mnemonic::Vpackstorelpd => todo!(),
            Mnemonic::Vpackstorelps => todo!(),
            Mnemonic::Vpackstorelq => todo!(),
            Mnemonic::Vpadcd => todo!(),
            Mnemonic::Vpaddsetcd => todo!(),
            Mnemonic::Vpaddsetsd => todo!(),
            Mnemonic::Vpcmpltd => todo!(),
            Mnemonic::Vpermf32x4 => todo!(),
            Mnemonic::Vpmadd231d => todo!(),
            Mnemonic::Vpmadd233d => todo!(),
            Mnemonic::Vpmulhd => todo!(),
            Mnemonic::Vpmulhud => todo!(),
            Mnemonic::Vprefetch0 => todo!(),
            Mnemonic::Vprefetch1 => todo!(),
            Mnemonic::Vprefetch2 => todo!(),
            Mnemonic::Vprefetche0 => todo!(),
            Mnemonic::Vprefetche1 => todo!(),
            Mnemonic::Vprefetche2 => todo!(),
            Mnemonic::Vprefetchenta => todo!(),
            Mnemonic::Vprefetchnta => todo!(),
            Mnemonic::Vpsbbd => todo!(),
            Mnemonic::Vpsbbrd => todo!(),
            Mnemonic::Vpsubrd => todo!(),
            Mnemonic::Vpsubrsetbd => todo!(),
            Mnemonic::Vpsubsetbd => todo!(),
            Mnemonic::Vrcp23ps => todo!(),
            Mnemonic::Vrndfxpntpd => todo!(),
            Mnemonic::Vrndfxpntps => todo!(),
            Mnemonic::Vrsqrt23ps => todo!(),
            Mnemonic::Vscaleps => todo!(),
            Mnemonic::Vscatterpf0hintdpd => todo!(),
            Mnemonic::Vscatterpf0hintdps => todo!(),
            Mnemonic::Vsubrpd => todo!(),
            Mnemonic::Vsubrps => todo!(),
            Mnemonic::Xsha512 => todo!(),
            Mnemonic::Xstore_alt => todo!(),
            Mnemonic::Xsha512_alt => todo!(),
            Mnemonic::Zero_bytes => todo!(),
            Mnemonic::Aadd => todo!(),
            Mnemonic::Aand => todo!(),
            Mnemonic::Aor => todo!(),
            Mnemonic::Axor => todo!(),
            Mnemonic::Prefetchit0 => todo!(),
            Mnemonic::Prefetchit1 => todo!(),
            Mnemonic::Rdmsrlist => todo!(),
            Mnemonic::Rmpquery => todo!(),
            Mnemonic::Tdpfp16ps => todo!(),
            Mnemonic::Vbcstnebf162ps => todo!(),
            Mnemonic::Vbcstnesh2ps => todo!(),
            Mnemonic::Vcvtneebf162ps => todo!(),
            Mnemonic::Vcvtneeph2ps => todo!(),
            Mnemonic::Vcvtneobf162ps => todo!(),
            Mnemonic::Vcvtneoph2ps => todo!(),
            Mnemonic::Vpdpbssd => todo!(),
            Mnemonic::Vpdpbssds => todo!(),
            Mnemonic::Vpdpbsud => todo!(),
            Mnemonic::Vpdpbsuds => todo!(),
            Mnemonic::Vpdpbuud => todo!(),
            Mnemonic::Vpdpbuuds => todo!(),
            Mnemonic::Wrmsrlist => todo!(),
            Mnemonic::Wrmsrns => todo!(),
            Mnemonic::Tcmmrlfp16ps => todo!(),
            Mnemonic::Tcmmimfp16ps => todo!(),
            Mnemonic::Pbndkb => todo!(),
            Mnemonic::Vpdpwsud => todo!(),
            Mnemonic::Vpdpwsuds => todo!(),
            Mnemonic::Vpdpwusd => todo!(),
            Mnemonic::Vpdpwusds => todo!(),
            Mnemonic::Vpdpwuud => todo!(),
            Mnemonic::Vpdpwuuds => todo!(),
            Mnemonic::Vsha512msg1 => todo!(),
            Mnemonic::Vsha512msg2 => todo!(),
            Mnemonic::Vsha512rnds2 => todo!(),
            Mnemonic::Vsm3msg1 => todo!(),
            Mnemonic::Vsm3msg2 => todo!(),
            Mnemonic::Vsm3rnds2 => todo!(),
            Mnemonic::Vsm4key4 => todo!(),
            Mnemonic::Vsm4rnds4 => todo!(),
            // Additional newer instruction variants
            Mnemonic::Clui => todo!(),
            Mnemonic::Cmpbexadd => todo!(),
            Mnemonic::Cmpbxadd => todo!(),
            Mnemonic::Cmplexadd => todo!(),
            Mnemonic::Cmplxadd => todo!(),
            Mnemonic::Cmpnbexadd => todo!(),
            Mnemonic::Cmpnbxadd => todo!(),
            Mnemonic::Cmpnlexadd => todo!(),
            Mnemonic::Cmpnlxadd => todo!(),
            Mnemonic::Cmpnoxadd => todo!(),
            Mnemonic::Cmpnpxadd => todo!(),
            Mnemonic::Cmpnsxadd => todo!(),
            Mnemonic::Cmpnzxadd => todo!(),
            Mnemonic::Cmpoxadd => todo!(),
            Mnemonic::Cmppxadd => todo!(),
            Mnemonic::Cmpsxadd => todo!(),
            Mnemonic::Cmpzxadd => todo!(),
        }
    }

    fn get_operand_value(&self, instruction: &Instruction, op_index: u32, state: &CpuState) -> Result<u64> {
        let operand = instruction.try_op_kind(op_index).unwrap();
        match operand {
            OpKind::Register => {
                let reg = instruction.op_register(op_index);
                Ok(self.get_register_value(reg, state))
            }
            OpKind::Immediate8 => Ok(instruction.immediate8() as u64),
            OpKind::Immediate16 => Ok(instruction.immediate16() as u64),
            OpKind::Immediate32 => Ok(instruction.immediate32() as u64),
            OpKind::Immediate64 => Ok(instruction.immediate64()),
            OpKind::Memory => {
                let addr = self.calculate_memory_address(instruction, op_index, state)?;
                state.read_u64(addr)
            }
            _ => Err(crate::EmulatorError::Cpu("Unsupported operand kind".to_string())),
        }
    }

    fn set_operand_value(&self, instruction: &Instruction, op_index: u32, value: u64, state: &mut CpuState) -> Result<()> {
        let operand = instruction.try_op_kind(op_index).unwrap();
        match operand {
            OpKind::Register => {
                let reg = instruction.op_register(op_index);
                self.set_register_value(reg, value, state);
                Ok(())
            }
            OpKind::Memory => {
                let addr = self.calculate_memory_address(instruction, op_index, state)?;
                state.write_u64(addr, value)
            }
            _ => Err(crate::EmulatorError::Cpu("Cannot set value to this operand".to_string())),
        }
    }

    fn get_register_value(&self, reg: iced_x86::Register, state: &CpuState) -> u64 {
        match reg {
            iced_x86::Register::RAX => state.registers.rax,
            iced_x86::Register::RBX => state.registers.rbx,
            iced_x86::Register::RCX => state.registers.rcx,
            iced_x86::Register::RDX => state.registers.rdx,
            iced_x86::Register::RSI => state.registers.rsi,
            iced_x86::Register::RDI => state.registers.rdi,
            iced_x86::Register::RBP => state.registers.rbp,
            iced_x86::Register::RSP => state.registers.rsp,
            iced_x86::Register::R8 => state.registers.r8,
            iced_x86::Register::R9 => state.registers.r9,
            iced_x86::Register::R10 => state.registers.r10,
            iced_x86::Register::R11 => state.registers.r11,
            iced_x86::Register::R12 => state.registers.r12,
            iced_x86::Register::R13 => state.registers.r13,
            iced_x86::Register::R14 => state.registers.r14,
            iced_x86::Register::R15 => state.registers.r15,
            iced_x86::Register::RIP => state.registers.rip,
            _ => 0,
        }
    }

    fn set_register_value(&self, reg: iced_x86::Register, value: u64, state: &mut CpuState) {
        match reg {
            iced_x86::Register::RAX => state.registers.rax = value,
            iced_x86::Register::RBX => state.registers.rbx = value,
            iced_x86::Register::RCX => state.registers.rcx = value,
            iced_x86::Register::RDX => state.registers.rdx = value,
            iced_x86::Register::RSI => state.registers.rsi = value,
            iced_x86::Register::RDI => state.registers.rdi = value,
            iced_x86::Register::RBP => state.registers.rbp = value,
            iced_x86::Register::RSP => state.registers.rsp = value,
            iced_x86::Register::R8 => state.registers.r8 = value,
            iced_x86::Register::R9 => state.registers.r9 = value,
            iced_x86::Register::R10 => state.registers.r10 = value,
            iced_x86::Register::R11 => state.registers.r11 = value,
            iced_x86::Register::R12 => state.registers.r12 = value,
            iced_x86::Register::R13 => state.registers.r13 = value,
            iced_x86::Register::R14 => state.registers.r14 = value,
            iced_x86::Register::R15 => state.registers.r15 = value,
            iced_x86::Register::RIP => state.registers.rip = value,
            _ => {}
        }
    }

    fn calculate_memory_address(&self, instruction: &Instruction, op_index: u32, state: &CpuState) -> Result<u64> {
        // Simplified memory address calculation
        // In a real implementation, this would properly handle all addressing modes
        let mut addr = 0u64;

        // For now, just use a simple base address
        // This is a placeholder implementation
        if instruction.op_count() > op_index {
            // Try to get a register value as base
            // if let Ok(reg) = instruction.try_op_register(op_index) addr = self.get_register_value(reg, state);,
        }

        Ok(addr)
    }

    fn update_arithmetic_flags(&self, result: u64, src: u64, dst: u64, is_subtraction: bool, state: &mut CpuState) {
        let _flags = state.registers.get_flags();
        
        // Zero flag
        state.registers.set_flag(RFlags::ZERO, result == 0);
        
        // Sign flag (MSB)
        state.registers.set_flag(RFlags::SIGN, (result & 0x8000000000000000) != 0);
        
        // Carry flag
        let carry = if is_subtraction {
            dst < src
        } else {
            result < dst
        };
        state.registers.set_flag(RFlags::CARRY, carry);
        
        // Overflow flag
        let overflow = if is_subtraction {
            ((dst ^ src) & (dst ^ result)) & 0x8000000000000000 != 0
        } else {
            ((dst ^ src) & (dst ^ result)) & 0x8000000000000000 != 0
        };
        state.registers.set_flag(RFlags::OVERFLOW, overflow);
        
        // Parity flag (even number of set bits in low byte)
        let low_byte = (result & 0xFF) as u8;
        let parity = low_byte.count_ones() % 2 == 0;
        state.registers.set_flag(RFlags::PARITY, parity);
    }

    fn update_logical_flags(&self, result: u64, state: &mut CpuState) {
        state.registers.set_flag(RFlags::ZERO, result == 0);
        state.registers.set_flag(RFlags::SIGN, (result & 0x8000000000000000) != 0);
        state.registers.set_flag(RFlags::CARRY, false);
        state.registers.set_flag(RFlags::OVERFLOW, false);
        
        let low_byte = (result & 0xFF) as u8;
        let parity = low_byte.count_ones() % 2 == 0;
        state.registers.set_flag(RFlags::PARITY, parity);
    }

    // Helper methods for flag updates
    fn update_shift_flags(&self, result: u64, _src: u64, count: u64, state: &mut CpuState) {
        // Update flags for shift operations
        state.registers.set_flag(RFlags::ZERO, result == 0);
        state.registers.set_flag(RFlags::SIGN, (result & 0x8000000000000000) != 0);
        state.registers.set_flag(RFlags::PARITY, (result.count_ones() & 1) == 0);
        
        // Carry flag is set to the last bit shifted out
        if count > 0 {
            let last_bit = (_src >> (count - 1)) & 1;
            state.registers.set_flag(RFlags::CARRY, last_bit != 0);
        }
        
        // Overflow flag is undefined for shift operations
        state.registers.set_flag(RFlags::OVERFLOW, false);
    }

    fn update_rotate_flags(&self, result: u64, _src: u64, count: u64, state: &mut CpuState) {
        // Update flags for rotate operations
        state.registers.set_flag(RFlags::ZERO, result == 0);
        state.registers.set_flag(RFlags::SIGN, (result & 0x8000000000000000) != 0);
        state.registers.set_flag(RFlags::PARITY, (result.count_ones() & 1) == 0);
        
        // Carry flag is set to the last bit rotated out
        if count > 0 {
            let last_bit = (_src >> (count - 1)) & 1;
            state.registers.set_flag(RFlags::CARRY, last_bit != 0);
        }
        
        // Overflow flag is undefined for rotate operations
        state.registers.set_flag(RFlags::OVERFLOW, false);
    }

}
